<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.51" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://vuepress-theme-hope-v2-demo.mrhope.site/blog/tech/%E5%89%8D%E7%AB%AF%E7%8A%B6%E6%80%81%E6%9C%BA%E7%B3%BB%E5%88%97%EF%BC%9ASCXML%E4%B8%8EXState%E5%AF%B9%E5%BA%94%E5%85%B3%E7%B3%BB.html"><meta property="og:site_name" content="åšå®¢"><meta property="og:title" content="å‰ç«¯çŠ¶æ€æœºç³»åˆ—ï¼šSCXMLä¸XStateå¯¹åº”å…³ç³»"><meta property="og:type" content="article"><meta property="og:image" content="https://vuepress-theme-hope-v2-demo.mrhope.site/blog/"><meta property="og:locale" content="zh-CN"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image:alt" content="å‰ç«¯çŠ¶æ€æœºç³»åˆ—ï¼šSCXMLä¸XStateå¯¹åº”å…³ç³»"><meta property="article:tag" content="çŠ¶æ€æœº"><meta property="article:published_time" content="2022-01-14T00:00:00.000Z"><title>å‰ç«¯çŠ¶æ€æœºç³»åˆ—ï¼šSCXMLä¸XStateå¯¹åº”å…³ç³» | åšå®¢</title><meta name="description" content=" ">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d2025;
      }

      html,
      body {
        background-color: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="stylesheet" href="/blog/assets/style.3d72beae.css">
    <link rel="modulepreload" href="/blog/assets/app.773cfef9.js"><link rel="modulepreload" href="/blog/assets/å‰ç«¯çŠ¶æ€æœºç³»åˆ—ï¼šSCXMLä¸XStateå¯¹åº”å…³ç³».html.fb5b019f.js"><link rel="modulepreload" href="/blog/assets/plugin-vue_export-helper.cdc0426e.js"><link rel="modulepreload" href="/blog/assets/å‰ç«¯çŠ¶æ€æœºç³»åˆ—ï¼šSCXMLä¸XStateå¯¹åº”å…³ç³».html.a04be808.js"><link rel="prefetch" href="/blog/assets/index.html.57d456d9.js"><link rel="prefetch" href="/blog/assets/index.html.8aee2c1a.js"><link rel="prefetch" href="/blog/assets/é™ä½å‰ç«¯ä¸šåŠ¡å¤æ‚åº¦æ–°è§†è§’ï¼šçŠ¶æ€æœºèŒƒå¼.html.368d5c08.js"><link rel="prefetch" href="/blog/assets/404.html.a0ab54bb.js"><link rel="prefetch" href="/blog/assets/index.html.74e2fb82.js"><link rel="prefetch" href="/blog/assets/index.html.b9680657.js"><link rel="prefetch" href="/blog/assets/index.html.89ac09eb.js"><link rel="prefetch" href="/blog/assets/index.html.9bfdeec8.js"><link rel="prefetch" href="/blog/assets/index.html.3e89b829.js"><link rel="prefetch" href="/blog/assets/index.html.0c763be9.js"><link rel="prefetch" href="/blog/assets/index.html.da3e60c5.js"><link rel="prefetch" href="/blog/assets/index.html.77943ede.js"><link rel="prefetch" href="/blog/assets/index.html.1e93708d.js"><link rel="prefetch" href="/blog/assets/index.html.7e940c4e.js"><link rel="prefetch" href="/blog/assets/é™ä½å‰ç«¯ä¸šåŠ¡å¤æ‚åº¦æ–°è§†è§’ï¼šçŠ¶æ€æœºèŒƒå¼.html.0b40acd2.js"><link rel="prefetch" href="/blog/assets/404.html.dd065ecb.js"><link rel="prefetch" href="/blog/assets/index.html.483bed7a.js"><link rel="prefetch" href="/blog/assets/index.html.3c846d26.js"><link rel="prefetch" href="/blog/assets/index.html.35f4075b.js"><link rel="prefetch" href="/blog/assets/index.html.64bdcf24.js"><link rel="prefetch" href="/blog/assets/index.html.55e8711e.js"><link rel="prefetch" href="/blog/assets/index.html.c4a18122.js"><link rel="prefetch" href="/blog/assets/index.html.ae6a5aa9.js"><link rel="prefetch" href="/blog/assets/index.html.dd000b37.js"><link rel="prefetch" href="/blog/assets/auto.f0b8ad4b.js"><link rel="prefetch" href="/blog/assets/index.5470b2f6.js"><link rel="prefetch" href="/blog/assets/flowchart.parse.c8d5341a.js"><link rel="prefetch" href="/blog/assets/mermaid.esm.min.72908bbb.js"><link rel="prefetch" href="/blog/assets/highlight.esm.87b79e05.js"><link rel="prefetch" href="/blog/assets/markdown.esm.45736620.js"><link rel="prefetch" href="/blog/assets/math.esm.2b7d37e9.js"><link rel="prefetch" href="/blog/assets/notes.esm.802ae293.js"><link rel="prefetch" href="/blog/assets/reveal.esm.16efd5a4.js"><link rel="prefetch" href="/blog/assets/search.esm.ff89a46c.js"><link rel="prefetch" href="/blog/assets/zoom.esm.d5422d51.js"><link rel="prefetch" href="/blog/assets/photoswipe.esm.d61c7bb4.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">Skip to content</a><!--]--><div class="theme-container no-sidebar has-toc"><!--[--><!--[--><header class="navbar"><div class="navbar-left"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><a href="/blog/" class="brand"><img class="logo" src="/blog/logo.svg" alt="åšå®¢"><!----><span class="site-name hide-in-pad">åšå®¢</span></a><!----></div><div class="navbar-center"><!----><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/blog/" class="nav-link" aria-label="åšå®¢ä¸»é¡µ"><span class="icon iconfont icon-home"></span>åšå®¢ä¸»é¡µ<!----></a></div><div class="nav-item hide-in-mobile"><a href="/blog/tech/" class="nav-link active" aria-label="æŠ€æœ¯"><span class="icon iconfont icon-template"></span>æŠ€æœ¯<!----></a></div></nav><!----></div><div class="navbar-right"><!----><!----><div class="nav-item"><a class="repo-link" href="https://github.com/lecepin/blog" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!----><!----><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->å‰ç«¯çŠ¶æ€æœºç³»åˆ—ï¼šSCXMLä¸XStateå¯¹åº”å…³ç³»</h1><div class="page-info"><span class="author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="down" localizeddate="2022å¹´1æœˆ14æ—¥" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><span class="author-item">ä¹å¹³</span></span><span property="author" content="ä¹å¹³"></span></span><!----><span class="date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="down" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span>2022å¹´1æœˆ14æ—¥</span><meta property="datePublished" content="2022-01-14T00:00:00.000Z"></span><!----><span aria-label="æ ‡ç­¾ğŸ·" data-balloon-pos="down" localizeddate="2022å¹´1æœˆ14æ—¥" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="tag icon"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><ul class="tags-wrapper"><li class="tag tag2 clickable" role="navigation">çŠ¶æ€æœº</li></ul><meta property="keywords" content="çŠ¶æ€æœº"></span><span class="reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="down" localizeddate="2022å¹´1æœˆ14æ—¥" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 33 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT33M"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><div class="toc-header">æ­¤é¡µå†…å®¹</div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/blog/tech/%E5%89%8D%E7%AB%AF%E7%8A%B6%E6%80%81%E6%9C%BA%E7%B3%BB%E5%88%97%EF%BC%9ASCXML%E4%B8%8EXState%E5%AF%B9%E5%BA%94%E5%85%B3%E7%B3%BB.html#_1-1-çŠ¶æ€å›¾" class="router-link-active router-link-exact-active toc-link level2">1.1 çŠ¶æ€å›¾</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/tech/%E5%89%8D%E7%AB%AF%E7%8A%B6%E6%80%81%E6%9C%BA%E7%B3%BB%E5%88%97%EF%BC%9ASCXML%E4%B8%8EXState%E5%AF%B9%E5%BA%94%E5%85%B3%E7%B3%BB.html#_1-2-scxml" class="router-link-active router-link-exact-active toc-link level2">1.2 SCXML</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/tech/%E5%89%8D%E7%AB%AF%E7%8A%B6%E6%80%81%E6%9C%BA%E7%B3%BB%E5%88%97%EF%BC%9ASCXML%E4%B8%8EXState%E5%AF%B9%E5%BA%94%E5%85%B3%E7%B3%BB.html#_1-3-xstate" class="router-link-active router-link-exact-active toc-link level2">1.3 XState</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/tech/%E5%89%8D%E7%AB%AF%E7%8A%B6%E6%80%81%E6%9C%BA%E7%B3%BB%E5%88%97%EF%BC%9ASCXML%E4%B8%8EXState%E5%AF%B9%E5%BA%94%E5%85%B3%E7%B3%BB.html#_2-1-scxml-çš„ç»„ç»‡" class="router-link-active router-link-exact-active toc-link level2">2.1 SCXML çš„ç»„ç»‡</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/tech/%E5%89%8D%E7%AB%AF%E7%8A%B6%E6%80%81%E6%9C%BA%E7%B3%BB%E5%88%97%EF%BC%9ASCXML%E4%B8%8EXState%E5%AF%B9%E5%BA%94%E5%85%B3%E7%B3%BB.html#_2-2-xstate-çš„ç»„ç»‡" class="router-link-active router-link-exact-active toc-link level2">2.2 XState çš„ç»„ç»‡</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/tech/%E5%89%8D%E7%AB%AF%E7%8A%B6%E6%80%81%E6%9C%BA%E7%B3%BB%E5%88%97%EF%BC%9ASCXML%E4%B8%8EXState%E5%AF%B9%E5%BA%94%E5%85%B3%E7%B3%BB.html#_3-1-æ ¸å¿ƒå…ƒç´ " class="router-link-active router-link-exact-active toc-link level2">3.1 æ ¸å¿ƒå…ƒç´ </a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/blog/tech/%E5%89%8D%E7%AB%AF%E7%8A%B6%E6%80%81%E6%9C%BA%E7%B3%BB%E5%88%97%EF%BC%9ASCXML%E4%B8%8EXState%E5%AF%B9%E5%BA%94%E5%85%B3%E7%B3%BB.html#_3-1-1-scxml" class="router-link-active router-link-exact-active toc-link level3">3.1.1 &lt;scxml&gt;</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/tech/%E5%89%8D%E7%AB%AF%E7%8A%B6%E6%80%81%E6%9C%BA%E7%B3%BB%E5%88%97%EF%BC%9ASCXML%E4%B8%8EXState%E5%AF%B9%E5%BA%94%E5%85%B3%E7%B3%BB.html#_3-1-2-state" class="router-link-active router-link-exact-active toc-link level3">3.1.2 &lt;state&gt;</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/tech/%E5%89%8D%E7%AB%AF%E7%8A%B6%E6%80%81%E6%9C%BA%E7%B3%BB%E5%88%97%EF%BC%9ASCXML%E4%B8%8EXState%E5%AF%B9%E5%BA%94%E5%85%B3%E7%B3%BB.html#_3-1-3-transition" class="router-link-active router-link-exact-active toc-link level3">3.1.3 &lt;transition&gt;</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/tech/%E5%89%8D%E7%AB%AF%E7%8A%B6%E6%80%81%E6%9C%BA%E7%B3%BB%E5%88%97%EF%BC%9ASCXML%E4%B8%8EXState%E5%AF%B9%E5%BA%94%E5%85%B3%E7%B3%BB.html#_3-1-4-initial" class="router-link-active router-link-exact-active toc-link level3">3.1.4 &lt;initial&gt;</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/tech/%E5%89%8D%E7%AB%AF%E7%8A%B6%E6%80%81%E6%9C%BA%E7%B3%BB%E5%88%97%EF%BC%9ASCXML%E4%B8%8EXState%E5%AF%B9%E5%BA%94%E5%85%B3%E7%B3%BB.html#_3-1-5-parallel" class="router-link-active router-link-exact-active toc-link level3">3.1.5 &lt;parallel&gt;</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/tech/%E5%89%8D%E7%AB%AF%E7%8A%B6%E6%80%81%E6%9C%BA%E7%B3%BB%E5%88%97%EF%BC%9ASCXML%E4%B8%8EXState%E5%AF%B9%E5%BA%94%E5%85%B3%E7%B3%BB.html#_3-1-6-final" class="router-link-active router-link-exact-active toc-link level3">3.1.6 &lt;final&gt;</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/tech/%E5%89%8D%E7%AB%AF%E7%8A%B6%E6%80%81%E6%9C%BA%E7%B3%BB%E5%88%97%EF%BC%9ASCXML%E4%B8%8EXState%E5%AF%B9%E5%BA%94%E5%85%B3%E7%B3%BB.html#_3-1-7-history" class="router-link-active router-link-exact-active toc-link level3">3.1.7 &lt;history&gt;</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/tech/%E5%89%8D%E7%AB%AF%E7%8A%B6%E6%80%81%E6%9C%BA%E7%B3%BB%E5%88%97%EF%BC%9ASCXML%E4%B8%8EXState%E5%AF%B9%E5%BA%94%E5%85%B3%E7%B3%BB.html#_3-1-8-onentry" class="router-link-active router-link-exact-active toc-link level3">3.1.8 &lt;onentry&gt;</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/tech/%E5%89%8D%E7%AB%AF%E7%8A%B6%E6%80%81%E6%9C%BA%E7%B3%BB%E5%88%97%EF%BC%9ASCXML%E4%B8%8EXState%E5%AF%B9%E5%BA%94%E5%85%B3%E7%B3%BB.html#_3-1-9-onexit" class="router-link-active router-link-exact-active toc-link level3">3.1.9 &lt;onexit&gt;</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/tech/%E5%89%8D%E7%AB%AF%E7%8A%B6%E6%80%81%E6%9C%BA%E7%B3%BB%E5%88%97%EF%BC%9ASCXML%E4%B8%8EXState%E5%AF%B9%E5%BA%94%E5%85%B3%E7%B3%BB.html#_3-2-å¯æ‰§è¡Œå†…å®¹" class="router-link-active router-link-exact-active toc-link level2">3.2 å¯æ‰§è¡Œå†…å®¹</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/blog/tech/%E5%89%8D%E7%AB%AF%E7%8A%B6%E6%80%81%E6%9C%BA%E7%B3%BB%E5%88%97%EF%BC%9ASCXML%E4%B8%8EXState%E5%AF%B9%E5%BA%94%E5%85%B3%E7%B3%BB.html#_3-2-1-raise" class="router-link-active router-link-exact-active toc-link level3">3.2.1 &lt;raise&gt;</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/tech/%E5%89%8D%E7%AB%AF%E7%8A%B6%E6%80%81%E6%9C%BA%E7%B3%BB%E5%88%97%EF%BC%9ASCXML%E4%B8%8EXState%E5%AF%B9%E5%BA%94%E5%85%B3%E7%B3%BB.html#_3-2-2-foreach" class="router-link-active router-link-exact-active toc-link level3">3.2.2 &lt;foreach&gt;</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/tech/%E5%89%8D%E7%AB%AF%E7%8A%B6%E6%80%81%E6%9C%BA%E7%B3%BB%E5%88%97%EF%BC%9ASCXML%E4%B8%8EXState%E5%AF%B9%E5%BA%94%E5%85%B3%E7%B3%BB.html#_3-2-3-log" class="router-link-active router-link-exact-active toc-link level3">3.2.3 &lt;log&gt;</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/tech/%E5%89%8D%E7%AB%AF%E7%8A%B6%E6%80%81%E6%9C%BA%E7%B3%BB%E5%88%97%EF%BC%9ASCXML%E4%B8%8EXState%E5%AF%B9%E5%BA%94%E5%85%B3%E7%B3%BB.html#_3-2-4-if-ã€-elseif-ã€-else" class="router-link-active router-link-exact-active toc-link level3">3.2.4 &lt;if&gt;ã€&lt;elseif&gt;ã€&lt;else&gt;</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/tech/%E5%89%8D%E7%AB%AF%E7%8A%B6%E6%80%81%E6%9C%BA%E7%B3%BB%E5%88%97%EF%BC%9ASCXML%E4%B8%8EXState%E5%AF%B9%E5%BA%94%E5%85%B3%E7%B3%BB.html#_3-3-æ•°æ®æ¨¡å‹å’Œæ•°æ®æ“ä½œ" class="router-link-active router-link-exact-active toc-link level2">3.3 æ•°æ®æ¨¡å‹å’Œæ•°æ®æ“ä½œ</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/blog/tech/%E5%89%8D%E7%AB%AF%E7%8A%B6%E6%80%81%E6%9C%BA%E7%B3%BB%E5%88%97%EF%BC%9ASCXML%E4%B8%8EXState%E5%AF%B9%E5%BA%94%E5%85%B3%E7%B3%BB.html#_3-3-1-datamodel" class="router-link-active router-link-exact-active toc-link level3">3.3.1 &lt;datamodel&gt;</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/tech/%E5%89%8D%E7%AB%AF%E7%8A%B6%E6%80%81%E6%9C%BA%E7%B3%BB%E5%88%97%EF%BC%9ASCXML%E4%B8%8EXState%E5%AF%B9%E5%BA%94%E5%85%B3%E7%B3%BB.html#_3-3-2-data" class="router-link-active router-link-exact-active toc-link level3">3.3.2 &lt;data&gt;</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/tech/%E5%89%8D%E7%AB%AF%E7%8A%B6%E6%80%81%E6%9C%BA%E7%B3%BB%E5%88%97%EF%BC%9ASCXML%E4%B8%8EXState%E5%AF%B9%E5%BA%94%E5%85%B3%E7%B3%BB.html#_3-3-3-assign" class="router-link-active router-link-exact-active toc-link level3">3.3.3 &lt;assign&gt;</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/tech/%E5%89%8D%E7%AB%AF%E7%8A%B6%E6%80%81%E6%9C%BA%E7%B3%BB%E5%88%97%EF%BC%9ASCXML%E4%B8%8EXState%E5%AF%B9%E5%BA%94%E5%85%B3%E7%B3%BB.html#_3-3-4-script" class="router-link-active router-link-exact-active toc-link level3">3.3.4 &lt;script&gt;</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/tech/%E5%89%8D%E7%AB%AF%E7%8A%B6%E6%80%81%E6%9C%BA%E7%B3%BB%E5%88%97%EF%BC%9ASCXML%E4%B8%8EXState%E5%AF%B9%E5%BA%94%E5%85%B3%E7%B3%BB.html#_3-3-5-donedata" class="router-link-active router-link-exact-active toc-link level3">3.3.5 &lt;donedata&gt;</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/tech/%E5%89%8D%E7%AB%AF%E7%8A%B6%E6%80%81%E6%9C%BA%E7%B3%BB%E5%88%97%EF%BC%9ASCXML%E4%B8%8EXState%E5%AF%B9%E5%BA%94%E5%85%B3%E7%B3%BB.html#_3-3-6-param" class="router-link-active router-link-exact-active toc-link level3">3.3.6 &lt;param&gt;</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/tech/%E5%89%8D%E7%AB%AF%E7%8A%B6%E6%80%81%E6%9C%BA%E7%B3%BB%E5%88%97%EF%BC%9ASCXML%E4%B8%8EXState%E5%AF%B9%E5%BA%94%E5%85%B3%E7%B3%BB.html#_3-3-7-content" class="router-link-active router-link-exact-active toc-link level3">3.3.7 &lt;content&gt;</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/tech/%E5%89%8D%E7%AB%AF%E7%8A%B6%E6%80%81%E6%9C%BA%E7%B3%BB%E5%88%97%EF%BC%9ASCXML%E4%B8%8EXState%E5%AF%B9%E5%BA%94%E5%85%B3%E7%B3%BB.html#_3-4-å¤–éƒ¨é€šè®¯" class="router-link-active router-link-exact-active toc-link level2">3.4 å¤–éƒ¨é€šè®¯</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/blog/tech/%E5%89%8D%E7%AB%AF%E7%8A%B6%E6%80%81%E6%9C%BA%E7%B3%BB%E5%88%97%EF%BC%9ASCXML%E4%B8%8EXState%E5%AF%B9%E5%BA%94%E5%85%B3%E7%B3%BB.html#_3-4-1-send" class="router-link-active router-link-exact-active toc-link level3">3.4.1 &lt;send&gt;</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/tech/%E5%89%8D%E7%AB%AF%E7%8A%B6%E6%80%81%E6%9C%BA%E7%B3%BB%E5%88%97%EF%BC%9ASCXML%E4%B8%8EXState%E5%AF%B9%E5%BA%94%E5%85%B3%E7%B3%BB.html#_3-4-2-cancel" class="router-link-active router-link-exact-active toc-link level3">3.4.2 &lt;cancel&gt;</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/tech/%E5%89%8D%E7%AB%AF%E7%8A%B6%E6%80%81%E6%9C%BA%E7%B3%BB%E5%88%97%EF%BC%9ASCXML%E4%B8%8EXState%E5%AF%B9%E5%BA%94%E5%85%B3%E7%B3%BB.html#_3-4-3-invoke" class="router-link-active router-link-exact-active toc-link level3">3.4.3 &lt;invoke&gt;</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/tech/%E5%89%8D%E7%AB%AF%E7%8A%B6%E6%80%81%E6%9C%BA%E7%B3%BB%E5%88%97%EF%BC%9ASCXML%E4%B8%8EXState%E5%AF%B9%E5%BA%94%E5%85%B3%E7%B3%BB.html#_3-4-4-finalize" class="router-link-active router-link-exact-active toc-link level3">3.4.4 &lt;finalize&gt;</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/tech/%E5%89%8D%E7%AB%AF%E7%8A%B6%E6%80%81%E6%9C%BA%E7%B3%BB%E5%88%97%EF%BC%9ASCXML%E4%B8%8EXState%E5%AF%B9%E5%BA%94%E5%85%B3%E7%B3%BB.html#_3-5-æœªå¯¹åº”-xstate-api" class="router-link-active router-link-exact-active toc-link level2">3.5 æœªå¯¹åº” XState API</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/tech/%E5%89%8D%E7%AB%AF%E7%8A%B6%E6%80%81%E6%9C%BA%E7%B3%BB%E5%88%97%EF%BC%9ASCXML%E4%B8%8EXState%E5%AF%B9%E5%BA%94%E5%85%B3%E7%B3%BB.html#_3-6-å¯¹åº”å¤§å›¾" class="router-link-active router-link-exact-active toc-link level2">3.6 å¯¹åº”å¤§å›¾</a></li><!----><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><p><img src="/blog/assets/1662725997780.dc54f796.webp" alt="" loading="lazy"></p><h1 id="_1-å‰ç½®è¯´æ˜" tabindex="-1"><a class="header-anchor" href="#_1-å‰ç½®è¯´æ˜" aria-hidden="true">#</a> 1. å‰ç½®è¯´æ˜</h1><p>è¿™æ¬¡å†è¯´æ˜ä¸‹è‡ªå·±å¯¹çŠ¶æ€å›¾çš„çœ‹æ³•ã€‚çŠ¶æ€å›¾è™½ç„¶æœ‰éå¸¸å¤šçš„ä¼˜åŠ¿ï¼ˆ<a href="https://github.com/lecepin/blog/blob/main/%E9%99%8D%E4%BD%8E%E5%89%8D%E7%AB%AF%E4%B8%9A%E5%8A%A1%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%96%B0%E8%A7%86%E8%A7%92%EF%BC%9A%E7%8A%B6%E6%80%81%E6%9C%BA%E8%8C%83%E5%BC%8F.md" target="_blank" rel="noopener noreferrer">å‚è€ƒä¸Šç¯‡æ–‡ç« <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ï¼‰ï¼Œå¦‚æœä½ æƒ³ä½¿ç”¨ï¼Œå…³äºæ˜¯å¦å¯¹æ•´ä¸ªæ—§é¡¹ç›®è¿›è¡Œå…¨é‡çŠ¶æ€å›¾åŒ–ï¼Œè¿™é‡Œç»™ä¸€ä¸ªé€‚åº”èŒƒå›´æ˜¯ï¼šé¡¹ç›®ä¸­å¤æ‚çš„éƒ¨åˆ†è¿›è¡ŒçŠ¶æ€å›¾å»ºæ¨¡æ˜¯éå¸¸åˆé€‚çš„ã€‚å¦‚æœä½ æœ‰ç²¾åŠ›æ˜¯å¯ä»¥å°è¯•å¯¹æ•´ä¸ªé¡¹ç›®è¿›è¡ŒçŠ¶æ€å›¾åŒ–çš„ã€‚</p><h2 id="_1-1-çŠ¶æ€å›¾" tabindex="-1"><a class="header-anchor" href="#_1-1-çŠ¶æ€å›¾" aria-hidden="true">#</a> 1.1 çŠ¶æ€å›¾</h2><p>å†å›é¡¾ä¸€ä¸‹ä»€ä¹ˆæ˜¯çŠ¶æ€å›¾ã€‚ çŠ¶æ€å›¾çš„å‰èº«æ˜¯çŠ¶æ€æœºï¼ˆFSMï¼‰ï¼ŒFSM ä½¿ç”¨è¿‡ç¨‹ä¸­ä¼šæš´éœ²ä¸€äº›é—®é¢˜ï¼Œå¦‚ï¼š</p><ul><li>çŠ¶æ€çˆ†ç‚¸</li><li>å±‚æ¬¡è¡¨è¾¾èƒ½åŠ›å¼±</li></ul><p>é¡¹ç›®å¤æ‚èµ·æ¥ï¼Œåˆ°åæœŸ FSM ä¼šå¾ˆéš¾ç»´æŠ¤ã€‚</p><p>é’ˆå¯¹è¿™äº›é—®é¢˜ï¼Œè®¡ç®—æœºç§‘å­¦å®¶ David Harel åœ¨ 1984 å¹´å¯¹ FSM è¿›è¡Œäº†æ‰©å±•ï¼Œå‘æ˜äº† çŠ¶æ€å›¾ï¼ˆSCï¼‰æ¥è§£å†³ FSM ä¸­çš„é—®é¢˜ã€‚ï¼ˆ<a href="http://www.inf.ed.ac.uk/teaching/courses/seoc/2005_2006/resources/statecharts.pdf" target="_blank" rel="noopener noreferrer">è®ºæ–‡åœ°å€<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ï¼‰</p><p>SC ä¸ä»…ä»…æ˜¯æ›´å¥½çš„å¯è§†åŒ–äº† FSMï¼Œè€Œä¸”å®ƒæ˜¯å¯æ‰§è¡Œçš„ã€‚ç°åœ¨çš„å¤§å¤šæ•°çŠ¶æ€æœºå·¥å…·åº“ï¼Œæ›´ç¡®åˆ‡çš„è¯´åº”è¯¥æ˜¯çŠ¶æ€å›¾å·¥å…·åº“ã€‚</p><p>SC å®šä¹‰ä¸ºä¸€ä¸ªåˆ†å±‚æœ‰å‘å›¾ï¼ˆSï¼ŒTï¼ŒRï¼ŒInï¼ŒOutï¼‰ï¼Œæ¯” FSM å¤šäº†ä¸€ä¸ª Rï¼ˆOrthogonal æ­£äº¤ï¼‰çš„æ¦‚å¿µã€‚</p><p>SC è®¾è®¡äº†ä¸€å¥—éå¸¸å¤æ‚ä¸”éå¸¸ç²¾ç¡®çš„ç¬¦å·ç³»ç»Ÿï¼Œå¢å¼ºäº†ç»“æ„å±‚æ¬¡çš„è¡¨è¾¾èƒ½åŠ›å’Œæœ‰å‘å›¾çš„è¿é€šè¡¨è¾¾èƒ½åŠ›ã€‚ç›®å‰ä¹Ÿæ˜¯ UML çš„é¦–é€‰æ§åˆ¶æ¨¡å‹ã€‚</p><h2 id="_1-2-scxml" tabindex="-1"><a class="header-anchor" href="#_1-2-scxml" aria-hidden="true">#</a> 1.2 SCXML</h2><p>SCXML å…¨ç§° State Chart XMLï¼Œç”¨äºæ§åˆ¶æŠ½è±¡çš„çŠ¶æ€æœºè¡¨ç¤ºæ³•ã€‚</p><p>SCXML æ˜¯åŸºäºä¸Šé¢è¯´çš„ David Harel çŠ¶æ€å›¾ å’Œ CCXMLï¼ˆCall Control eXtensible Markup Languageï¼‰ è¿›è¡Œæ‰©å±•çš„ä¸€å¥—è§„èŒƒã€‚</p><p>ä» 2005 å¹´åˆ° 2015 å¹´ç»å† 10 å¹´å®šåˆ¶çš„è§„èŒƒï¼Œæˆä¸º W3C æ¨èè§„èŒƒã€‚ç›®å‰å¤§éƒ¨åˆ†ç¼–ç¨‹è¯­è¨€çš„çŠ¶æ€æœºå·¥å…·éƒ½æ˜¯åŸºäºæ­¤è§„èŒƒå®æ–½çš„ã€‚</p><h2 id="_1-3-xstate" tabindex="-1"><a class="header-anchor" href="#_1-3-xstate" aria-hidden="true">#</a> 1.3 XState</h2><p>XState æ˜¯ä¸€ä¸ªå‰ç«¯çš„çŠ¶æ€å›¾å·¥å…·åº“ï¼Œç”±å¾®è½¯å·¥ç¨‹å¸ˆ David Khourshid å¼€å‘ã€‚ç›®å‰æ˜¯å‰ç«¯çŠ¶æ€æœºé‡Œé¢ Star æœ€å¤šçš„ï¼Œæœ¬äººä½“éªŒä¸‹æ¥æ„Ÿè§‰ä¹Ÿå¾ˆä¸é”™ï¼ˆæœ¬äººå¾ˆé«˜å…´åœ¨æ­¤ä»“åº“è´¡çŒ®äº† 14.7k è¡Œ ï¼‰ã€‚ä¸‹å›¾æ˜¯ XState Github Star è®°å½•ï¼š</p><p><img src="/blog/assets/1662726060504.105e9114.webp" alt="" loading="lazy"></p><h1 id="_2-ç»„ç»‡è¯´æ˜" tabindex="-1"><a class="header-anchor" href="#_2-ç»„ç»‡è¯´æ˜" aria-hidden="true">#</a> 2. ç»„ç»‡è¯´æ˜</h1><p>XState çš„æ–‡æ¡£å†™çš„å¹¶ä¸æ˜¯å¾ˆå¥½æ‡‚ï¼Œå¾ˆå¤šæ¦‚å¿µè·³æ¥è·³å»ï¼ˆå½“ç„¶ å¤§å¤šæ•°å›½å¤–çš„æ–‡æ¡£éƒ½æœ‰è¿™ç§é—®é¢˜ï¼Œä½œè€…è‚¯å®šå¾ˆæƒ³è¡¨è¾¾æ¸…æ¥šï¼Œä½†å¹¶ä¸å®¹æ˜“åšï¼‰ï¼Œå¦‚æœè¯»è€…å¯¹çŠ¶æ€æœºæ²¡æœ‰æ¦‚å¿µï¼Œçªå¦‚å…¶æ¥çš„ä¸€å †æ–°çš„æ¦‚å¿µä¼šè®©ä½ æªæ‰‹ä¸åŠï¼Œå­¦ä¹ æ›²çº¿å‰§å¢ï¼Œä½¿ç”¨ä¸Šä¹Ÿä¸çŸ¥è¯¥å¦‚ä½•ä¸‹æ‰‹ã€‚</p><p>å¦‚æœæƒ³è¦å¯¹è¿™äº›æ¦‚å¿µæœ‰æ›´å¥½çš„è®¤è¯†å’Œç»„ç»‡ï¼Œé‚£ç”¨ SCXML å’Œ XState å»å¯¹ç…§ç€çœ‹ï¼Œæˆ–è®¸æ˜¯æ¯”è¾ƒåˆé€‚çš„ã€‚</p><h2 id="_2-1-scxml-çš„ç»„ç»‡" tabindex="-1"><a class="header-anchor" href="#_2-1-scxml-çš„ç»„ç»‡" aria-hidden="true">#</a> 2.1 SCXML çš„ç»„ç»‡</h2><p>ä¸»è¦æœ‰ä»¥ä¸‹éƒ¨åˆ†ï¼š</p><ul><li>æ ¸å¿ƒ <ul><li><code>&lt;scxml&gt;</code></li><li><code>&lt;state&gt;</code></li><li><code>&lt;transition&gt;</code></li><li><code>&lt;initial&gt;</code></li><li><code>&lt;parallel&gt;</code></li><li><code>&lt;final&gt;</code></li><li><code>&lt;history&gt;</code></li><li><code>&lt;onentry&gt;</code></li><li><code>&lt;onexit&gt;</code></li></ul></li><li>å¯æ‰§è¡Œå†…å®¹ <ul><li><code>&lt;raise&gt;</code></li><li><code>&lt;foreach&gt;</code></li><li><code>&lt;log&gt;</code></li><li><code>&lt;if&gt;</code></li><li><code>&lt;elseif&gt;</code></li><li><code>&lt;else&gt;</code></li></ul></li><li>æ•°æ®æ¨¡å‹å’Œæ•°æ®æ“ä½œ <ul><li><code>&lt;datamodel&gt;</code></li><li><code>&lt;data&gt;</code></li><li><code>&lt;content&gt;</code></li><li><code>&lt;param&gt;</code></li><li><code>&lt;donedata&gt;</code></li><li><code>&lt;script&gt;</code></li><li><code>&lt;assign&gt;</code></li></ul></li><li>å¤–éƒ¨é€šè®¯ <ul><li><code>&lt;send&gt;</code></li><li><code>&lt;cancel&gt;</code></li><li><code>&lt;invoke&gt;</code></li><li><code>&lt;finalize&gt;</code></li></ul></li></ul><h2 id="_2-2-xstate-çš„ç»„ç»‡" tabindex="-1"><a class="header-anchor" href="#_2-2-xstate-çš„ç»„ç»‡" aria-hidden="true">#</a> 2.2 XState çš„ç»„ç»‡</h2><p>ä¸»è¦æœ‰ä»¥ä¸‹éƒ¨åˆ†ï¼š</p><ul><li>Machine</li><li>State</li><li>State Node</li><li>Event</li><li>Transition</li><li>Parallel State</li><li>Final State</li><li>History State</li><li>Effects <ul><li>Invoke</li><li>Actions <ul><li>send</li><li>raise</li><li>respond</li><li>forwardTo</li><li>escalate</li><li>log</li><li>choose</li><li>pure</li><li>assign</li></ul></li><li>Activities</li></ul></li><li>Context</li><li>Guard</li><li>Delay</li><li>Interpret</li><li>Identify</li><li>Actor</li><li>Model</li></ul><h1 id="_3-å¯¹åº”å…³ç³»" tabindex="-1"><a class="header-anchor" href="#_3-å¯¹åº”å…³ç³»" aria-hidden="true">#</a> 3. å¯¹åº”å…³ç³»</h1><p>ä¸‹é¢ä»¥ SCXML ä¸ºä¸»çº¿å»åšå¯¹åº”æè¿°ã€‚</p><h2 id="_3-1-æ ¸å¿ƒå…ƒç´ " tabindex="-1"><a class="header-anchor" href="#_3-1-æ ¸å¿ƒå…ƒç´ " aria-hidden="true">#</a> 3.1 æ ¸å¿ƒå…ƒç´ </h2><p>æŒ‰ç…§ SCXML çš„åˆ†ç±»ï¼Œå…ˆä»æ ¸å¿ƒéƒ¨åˆ†çš„å…ƒç´ è¿›è¡Œå¯¹åº”è¯´æ˜ã€‚</p><h3 id="_3-1-1-scxml" tabindex="-1"><a class="header-anchor" href="#_3-1-1-scxml" aria-hidden="true">#</a> 3.1.1 <code>&lt;scxml&gt;</code></h3><p><code>&lt;scxml&gt;</code>ï¼Œæœ€å¤–å±‚çš„çŠ¶æ€æœºåŒ…è£¹å…ƒç´ ï¼Œæºå¸¦ç‰ˆæœ¬ä¿¡æ¯ï¼ŒçŠ¶æ€æœºæ˜¯ç”±å®ƒçš„ children ç»„æˆçš„ã€‚</p><p>å±æ€§å­—æ®µæè¿°å¦‚ä¸‹ï¼š</p><table><thead><tr><th>åç§°</th><th>å¿…å¡«</th><th>å±æ€§çº¦æŸ</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>æœ‰æ•ˆå€¼</th><th>æè¿°</th></tr></thead><tbody><tr><td>initial</td><td>false</td><td>none</td><td>IDREFS</td><td>none</td><td>åˆæ³•çš„çŠ¶æ€è§„èŒƒ</td><td>çŠ¶æ€æœºçš„åˆå§‹çŠ¶æ€çš„ idã€‚å¦‚æœæœªæŒ‡å®šï¼Œåˆ™é»˜è®¤åˆå§‹çŠ¶æ€æ˜¯æ–‡æ¡£é¡ºåºä¸­çš„ç¬¬ä¸€ä¸ªå­çŠ¶æ€</td></tr><tr><td>name</td><td>false</td><td>none</td><td>NMTOKEN</td><td>none</td><td>ä»»ä½•æœ‰æ•ˆçš„ NMTOKEN</td><td>æ­¤çŠ¶æ€æœºçš„åç§°ã€‚å®ƒçº¯ç²¹æ˜¯ä¸ºäº†æä¾›ä¿¡æ¯</td></tr><tr><td>xmlns</td><td>true</td><td>none</td><td>URI</td><td>none</td><td><a href="http://www.w3.org/2005/07/scxml" target="_blank" rel="noopener noreferrer">http://www.w3.org/2005/07/scxml<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></td><td></td></tr><tr><td>version</td><td>true</td><td>none</td><td>decimal</td><td>none</td><td>å¿…é¡» &quot;1.0&quot;</td><td></td></tr><tr><td>datamodel</td><td>false</td><td>none</td><td>NMTOKEN</td><td>platform-specific</td><td>&quot;null&quot;, &quot;ecmascript&quot;, &quot;xpath&quot; æˆ–è€…å…¶ä»–å¹³å°å®šä¹‰çš„å€¼</td><td>æœ¬æ–‡æ¡£æ‰€éœ€çš„æ•°æ®æ¨¡å‹ã€‚ â€œnullâ€è¡¨ç¤º Null æ•°æ®æ¨¡å‹ï¼Œâ€œecmascriptâ€è¡¨ç¤º ECMAScript æ•°æ®æ¨¡å‹ï¼Œâ€œxpathâ€è¡¨ç¤º XPath æ•°æ®æ¨¡å‹</td></tr><tr><td>binding</td><td>false</td><td>none</td><td>enum</td><td>&quot;early&quot;</td><td>&quot;early&quot;, &quot;late&quot;</td><td>è¦ä½¿ç”¨çš„æ•°æ®ç»‘å®š</td></tr></tbody></table><p>children å¯ä»¥åŒ…å«ï¼š</p><ul><li><code>&lt;state&gt;</code></li><li><code>&lt;parallel&gt;</code></li><li><code>&lt;final&gt;</code></li><li><code>&lt;datamodel&gt;</code></li><li><code>&lt;script&gt;</code></li></ul><p>å¯¹åº” XState æ˜¯ Machineï¼ŒMachine çš„éƒ¨åˆ†å±æ€§æè¿°å¦‚ä¸‹ï¼ˆ<a href="https://github.com/statelyai/xstate/blob/xstate%404.27.0/packages/core/src/types.ts#L763" target="_blank" rel="noopener noreferrer">è¯¦æƒ…<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ï¼‰ï¼š</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;initial&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;context&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;states&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-1-2-state" tabindex="-1"><a class="header-anchor" href="#_3-1-2-state" aria-hidden="true">#</a> 3.1.2 <code>&lt;state&gt;</code></h3><p><code>&lt;state&gt;</code>ï¼Œç”¨æ¥æè¿°çŠ¶æ€æœºä¸­çš„çŠ¶æ€ã€‚</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scxml</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€æœº<span class="token punctuation">&quot;</span></span> <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1.0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2005/07/scxml<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>state</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€A<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scxml</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å±æ€§å­—æ®µæè¿°å¦‚ä¸‹ï¼š</p><table><thead><tr><th>åç§°</th><th>å¿…å¡«</th><th>å±æ€§çº¦æŸ</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>æœ‰æ•ˆå€¼</th><th>æè¿°</th></tr></thead><tbody><tr><td>id</td><td>false</td><td>none</td><td>ID</td><td>none</td><td></td><td>çŠ¶æ€ ID</td></tr><tr><td>initial</td><td>false</td><td>ä¸å¾—ä¸ <code>&lt;initial&gt;</code> å…ƒç´ ä¸€èµ·æŒ‡å®šã€‚ç»ä¸èƒ½ä»¥åŸå­çŠ¶æ€å‡ºç°ã€‚</td><td>IDREFS</td><td>none</td><td></td><td>æ­¤çŠ¶æ€çš„é»˜è®¤åˆå§‹çŠ¶æ€</td></tr></tbody></table><p>children å¯ä»¥åŒ…å«ï¼š</p><ul><li><code>&lt;onentry&gt;</code></li><li><code>&lt;onexit&gt;</code></li><li><code>&lt;transition&gt;</code></li><li><code>&lt;initial&gt;</code></li><li><code>&lt;state&gt;</code></li><li><code>&lt;parallel&gt;</code></li><li><code>&lt;final&gt;</code></li><li><code>&lt;history&gt;</code></li><li><code>&lt;datamodel&gt;</code></li><li><code>&lt;invoke&gt;</code></li></ul><p>å¯¹åº” XState çš„ State Nodeã€‚ä¸è¿‡ State Node æ˜¯ä¸€ä¸ª SCXML å¤šä¸ªå…ƒç´ ç»„æˆçš„ä¸€ä¸ªå±æ€§ã€‚ç”± <code>&lt;state&gt;</code>ã€<code>&lt;initial&gt;</code>ã€<code>&lt;parallel&gt;</code>ã€<code>&lt;final&gt;</code>ã€<code>&lt;history&gt;</code>ç»„æˆã€‚</p><p>State Node çš„éƒ¨åˆ†å±æ€§æè¿°å¦‚ä¸‹ï¼ˆ<a href="https://github.com/statelyai/xstate/blob/xstate%404.27.0/packages/core/src/types.ts#L505" target="_blank" rel="noopener noreferrer">è¯¦æƒ…<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ï¼‰ï¼š</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;states&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;invoke&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;on&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;onEntry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;onExit&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;onDone&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;always&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;after&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;tags&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç¤ºä¾‹ï¼š</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token function">Machine</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&quot;çŠ¶æ€æœº&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">states</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    çŠ¶æ€<span class="token constant">A</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&quot;çŠ¶æ€A&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="data:image/webp;base64,UklGRh4PAABXRUJQVlA4IBIPAACwtwCdASokBmIBPpFIn0ylpCMiIFOogLASCWlu4Xf17Y2hoD8AeurRtNPP+R+yH/HfkZ55+SH1N7icg3pP/i9wv8x67v27vf4AXrfdYwAfVbv69SzIA/kv9a/5vHXUAP5t/o/+t6oX1J6APq7p0PX7+8QLbELp3U1ATK3N9TUBMrc31NPMMZtkvVNG0bRtG0bRtG0bRtG0bRtG0bRtCL1hkYzWd67k6ZYy27Hnv5V0POHV5t2PPfyrVmIXTupqAmVub6moCZW5vpu0ohk6qL4K6x7huse4brHuO/MW9LOqizELp3U1ATK3N9TUBMrc31NQEytzfU1ATK3N9TUBMrc31NGIlV2Bdc9fovhZiy/A8LIrcntZnE29p6MLYI9BhMknYPU1ATK3N9TUBMrc31NQEytzfU1ATK3N9TUBMrc31NQEytzcjy/H7Z/bsgDGVRoqyjDRC2wAa/5JNBRlADSuhOTsRjxcDbrq0IWB/YUwPm3z74BkSsCXe6mnm5qZ3U1ATK3N9TUBMrc31NQEytzfU1ATK3N9TUBMrc31NQEysu7ESBHBrAPFHUuPBB/JHFoqfcU/ESUA9IDYbG0GEpJKx4bUAKfRjlYK5zHcnF+BDdR4XHWGS0IXTupqAmVub6moCZW5vqagJlbm+pqAmVub6moCZW5vqagIxWKZqzERtvqaebmpndTUBMrc31NQEytzfU1ATK3N9TUBMrc31NQEytzfU1ATKy7qyGIRX24PILcHkFuDyC3B5Bbg8gtOkQZWyagJlbm+pqAmVub6moCZW5vqagJlbm+pqAmVub6moCZW5vixFsHqagJlbm+LGsW5vqagJlbm+pqAmVub6moCZW5vqagJlbm+pqAmVub6moCYO7EtCF07qagJg8B1mZiF07qagJlbm+pqAmVub6moCZW5vqagJlbm+pqAmVub6cIlaMmoCZW5vpwloQundTUBMrc31NQEytzfU1ATK3N9TUBMrc31NQEytzfU1ARisWYuwCLc31NPNzUzupqAmVub6moCZW5vqagJlbm+pqAmVub6moCZW5vqagJlZd2JaB276r5fteuFgiLc3ex2GS0IXTupqAmVub6moCZW5vqagJlbm+pqAmVub6moCZW5vqagIxWKZq+qRsViKwaaCJ0SF8aD8B1mZiF07qagJlbm+pqAmVub6moCZW5vqagJlbm+pqAmVub6cIlkRpmMsZIm2um3eMwdju6RNAko6gGvHBPnhmgA5NyrTXlKjJL+J5tAxT7aeeO+zLRk1ATK3N9TUBMrc31NQEytzfU1ATK3N9TUBMrc31NQEytzfFiLYPXat9K/EoWnyUbT3e6gWEe/eJUBzo3OybMs1gaSbyJxPQFsoliUlNKdQhGAOerGI/4YShAWARbm+pqAmVub6moCZW5vqagJlbm+pqAmVub6moCZW5vqaebd4DrlKQedA6wOikaRTdHmZs7ewepqAmVub6moCZW5vqagJlbm+pqAmVub6moCZW5vqagJlbm5Hl/HYsK8Gi+wppFrM7QjlNNHgwpbmpndTUBMrc31NQEytzfU1ATK3N9TUBMrc31NQEytzfU1ATKy7sS0IXTupvVVc7B6moCZW5vqagJlbm+pqAmVub6moCZW5vqagJlbm+pqAmVubkeXmpndTUBMrbaAsAi3N9TUBMrc31NQEytzfU1ATK3N9TUBMrc31NQEytzfU0827zgjUBMrc31Lcaxbm+pqAmVub6moCZW5vqagJlbm+pqAmVub6moCZW5vqagJgkUp2WQH0xxmZW5vqaeUvr9GVwEW5vqagJlbm+pqAmVub6moCZW5vqagJlbm+pqAmVub6moBfTRP1UYx8mSZJkmSZJkmSZJkmSZJkmSZJkmMqZWejtWYhdO6moCZW5vqagJlbm+pqAmVub6moCZW5vqagJlbm+pqAmVub6moCZga6zMxC6d1NQEytzfU1ATK3N8QAAD+/+OdAH965x9ShaA+CIOtog0a9eCI7FCf/ZGckxjb7I7n8mz/s0FtbtfkDbAx6RxdXWeb6NP6bzt/8w7ly+4n9cxnvNIFDQ9txomnrs5mXZzMuzmZdnMy7OZl2czLs5mXZzMuzmZdnMy7OZl2czLs5mXZzMuzmZdnMy7OZl2czLhQN3VQIYC5q8AvEvaEfnzl7O1aZ/xh6FBSGBLgrhTWiuT72Uem+hQONdbU8zeYp5leK6D3mGXVRJqp7eZJuESamXVlL/yRJrJuJS/M5jK8PylMF0GyvDM5m8xTzK8V0HvMWDVdjjZKcMNDsQrETyL/2BizoC8XnWXy+e2yStuYUAAAAAAAE6vSpOl8tBzQjyZv48jLTlWt1S4R6UUJFd7NhmAY+7BLSKDrIhk4kuwvRf+ZI6aV3eRH+fzt1leiN6I1DoHPJbsz+K5JFNi3Fu1rlRj6PW+4FRHwK/gt74qPBYbb8jEVH+X5vOdQzZyDdFAcUfz4dn/6Ct3Z3Pjbm/v4pIGzXZ6OB8dWI+ec3Xj8S/9bx4cjR7Bc2aQ7X0IuHDUd8DkcJeaa51muYQDtv6effyzIyr0DjjZkqqIM8SAHLqYwyocAAC9wWSMLQgETzmUGL7FR/m/uMc8kMTXRX8wiekz+MxLvj4G9/+MCW9tnJqTKBJKc2SGd0vUxHzCYzmijiNiVhAwcEOqvra4v9+Uha2PJbB1XiN0xZpArWz7qAfprsDqHZPaNA6668pIJ7AP8Ofm6gtn291FvGnVI9ZpiBAl87xPmj+xlpUqKqsSrctU2+L84PHYWICFypH3L2c5mXMLQrrRgU6ckYtH34f13PGE5sK0A7nrTJANRKTu+ENotQknNKHP+AsoMQzkku8m7ClcyUYBNlQLXds21Ip4ZYuGImsf2Aai7PBH2IOl7HPdMmH+7MyZAYAaaIHJ7YkUhNZ6DzH5h/aiWM3V3VF8t0UxpEIqXGkRu++Qehv48tJYCsXzIJokffqyfNC1Ihl46IP7zHfZvzTz148Ip2X1KV3kU4uKs3UJfSE1PZnrRgV4WBwrV6ehKnKYVA6zFAxKJE859ytja02GvHFtpGNnYn5bRCAKod7SntOruEsJV0uvzBGkHpyhkW4lD0pEI9pohpL+7MsQT3/T0ak24S1zI+cDQMotW3nn1T/UEiSclz/uS+36+WwjkZmz88LGcruGrTHrZ5hwP3T8cOK/7g2d2VoSzKJCaEwFtUcAADTFh2b71yKgJ8DgZ+b1jLZk8txY/v0ntm6E61/4aA9PzlXjbf5w8Y5sxXhb2OcJrUfwcjdIZii2Zz/vPXmuDJen6K80MfC117THTlSO7USCltquFTFpKdkG7f88q9M5udE2TXSXulElE1Fqa0Y6KuiSMGQ4hID+kchKoIJefL0umkXYJhK9AyB9d3SkYqKTREVcrgedw0SGVAR0a5HXwLP+thEH6NmkVbUYafEd7aP4MobS4i3tQ2vW9UwcX9n9w/Gz0SOd71vhXylwcSw+sK2gcB2D1xa6QNHjaX2JkAhsa76uv0FgElXFyk7Rsm/lSaR8jkVhjITPAnf7i4Hh+EjSCNgY6vac+i5J5PdYxLX5vU11SXbMDK54ukXZNQvUD+5hH9TFwu43+OLdOO/nxVzny1Y2cl4fzbHe3xvf1foLPLo5stVILR9MOX6SOpOeNpCjUgFVvJhIHOx3+SZSne2Z2FweFYL4FTEbHTNeW2SKFRiKX80o6YzV3APkL63IaPpkZu2UFAAAksz0pBi5ubAgAA1gdkI4+hy1WVH51flraj5B7viRpebpQZGOAABxAApAGB4lDghg/JGuwAACtJBncMAAATMnZLUUAAB1kn9Uu66YAAEDDIo8o0aom79TV2AAAnARI+VsF1bmANmU9EiBuwIZjtoAc9s/OKFIrXanuhVx2GFwD838oukx58elYY49qGiyhvWhDAAAFoSs65kqhCNFypw4GqhS0+UlEnUs79wpgE97qfhdisKGkZNob3rUBZAjO/SJMiNIDGsyDKE/1prwK5wJ/P7KhkDWkMdgapsdMYcRgvktnOOsmW/HRZcmMrUpPgmtgHOhWH/RbRz4E/HqwYOrSBbpRmt9Rfwo3HSwT64PZVmvyyj606q8ljK/lYsqzwSYa359TV6S2Bfz83DA8pO9hy7arY8eIkgqOM38wZzsGiiq2y5yBO90zBIN1QAFmV7lLeANJKjFrDt1UclyTQKvsBzV27qFkXNBDsFQWcaFJti4qiKbhlWoj7hs+wh1Av0yUTkx8/G2tzIH6zT3WoC5ZeNb9d70OEfmubYCo4EBPlSLzqcXSQMxzeJ5cmVTuXjx9KFMjVQ7aS3Rs6cefg5gspOg56/9aPizopVwYgC9LUUAABbIXAGOIWGJNHolj+47tuYaaGwbYxdnOOPSs+71mc5M+ZtXU5j6qYkrF9Iw7sb3AB64UVe/m3fDWYr/RrqIQAj9t9iVXN5lXggI8IJqXCSuDcKE0k1fyn+A2H+f4HeKjcBjzb1hJLaaBzIbEsJOUM2e1DTJZXjliniXvfzP8FocTZ+hPtXfWMMtRIU2rzuPc6fxw5RtbwUP0OojhyWcRjeFLXG2PIqeC1RJPZpHAycVJx8wsOQXwUUrKcwWPyaSSFqZZxglPNTuHq/ZNX5MRDMkSt/HfisQyQUMeEohrmajiTQKoDKMsC5HdCwzRfONEsnPpXVAf9gwWpWioevuUSRcq6Hc4hCZiU9JPFm291CDxg6d+WU2yvkXynfqc57XWZKE7K8KTxcOtGMpOeC6CI8eaB/91pgYNVCmKLEE4XSCY0sp1Q4C/Fec/DmfOx8J5tlzTHRY6B1vOOIs3NTTHtSWVIx0Q2Ve7v7Afh38/X20ufFSGvII8z5wUrEcWE+XUl3XTAAAjhWrQskrzP5eTHf/sgfyy0ZfgUTS0ASxqkmCbwkHxDOPimg0Nzs2gbF7cjCK+gASldgAALYlQdCUT16QXKELXYAAC2QRdy1FAAAY/xVJd10wAAKbGairsAAAkSCVNfvAOtYz9Y68xqwBFsAWBXoP36Xi99xDc6idrAAaAAADT7/M8ecK8lZStSBx+FvjrvGvz35/yQWLSaJaV6UekS4Oj2EHwIPgQfAg+BB8CD4EHwF2y8dv7zUcn0ggs7loRMBCaGFhHd91JIAAAAAAAAAA=" alt="" loading="lazy"></p><h3 id="_3-1-3-transition" tabindex="-1"><a class="header-anchor" href="#_3-1-3-transition" aria-hidden="true">#</a> 3.1.3 <code>&lt;transition&gt;</code></h3><p>çŠ¶æ€ä¹‹é—´è¿›è¡Œè½¬æ¢ã€‚ç”±äº‹ä»¶è§¦å‘ï¼Œé€šè¿‡æ¡ä»¶åˆ¤æ–­åè¿›è¡Œè½¬æ¢ã€‚</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scxml</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€æœº<span class="token punctuation">&quot;</span></span> <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1.0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2005/07/scxml<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>state</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>æ‰“å¼€<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transition</span> <span class="token attr-name">cond</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>_event.data==1<span class="token punctuation">&quot;</span></span> <span class="token attr-name">event</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ç‚¹å‡»<span class="token punctuation">&quot;</span></span> <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>å…³é—­<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>state</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>state</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>å…³é—­<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scxml</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å±æ€§å­—æ®µæè¿°å¦‚ä¸‹ï¼š</p><table><thead><tr><th>åç§°</th><th>å¿…å¡«</th><th>å±æ€§çº¦æŸ</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>æœ‰æ•ˆå€¼</th><th>æè¿°</th></tr></thead><tbody><tr><td>event</td><td>false</td><td></td><td>EventsTypes.datatype</td><td>none</td><td>ä»¥ç©ºæ ¼åˆ†éš”çš„äº‹ä»¶æè¿°ç¬¦åˆ—è¡¨</td><td>è§¦å‘æ­¤è½¬æ¢çš„äº‹ä»¶æŒ‡ç¤ºç¬¦åˆ—è¡¨</td></tr><tr><td>cond</td><td>false</td><td></td><td>Boolean expression</td><td>&#39;true&#39;</td><td>å¸ƒå°”è¡¨è¾¾å¼</td><td>è½¬æ¢æ¡ä»¶</td></tr><tr><td>target</td><td>false</td><td></td><td>IDREFS</td><td>none</td><td>è¦è·³è½¬åˆ°çš„çŠ¶æ€</td><td>è¦è½¬æ¢åˆ°çš„çŠ¶æ€æˆ–å¹¶è¡ŒåŒºåŸŸçš„æ ‡è¯†ç¬¦</td></tr><tr><td>type</td><td>false</td><td></td><td>enum</td><td>&quot;external&quot;</td><td>&quot;internal&quot; &quot;external&quot;</td><td>ç¡®å®šç›®æ ‡çŠ¶æ€æ˜¯æ¥è‡ªäºå†…éƒ¨è½¬æ¢è¿˜æ˜¯å¤–éƒ¨è½¬æ¢</td></tr></tbody></table><p>children å¯ä»¥åŒ…å« å¯æ‰§è¡Œå†…å®¹ã€‚</p><p>å¯¹åº” XState çš„ Eventã€Transitionã€Guardã€‚éƒ¨åˆ†å±æ€§æè¿°å¦‚ä¸‹ï¼ˆ<a href="https://github.com/statelyai/xstate/blob/xstate%404.27.0/packages/core/src/types.ts#L445" target="_blank" rel="noopener noreferrer">è¯¦æƒ…<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ï¼‰ï¼š</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;on&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;*&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;è‡ªå®šä¹‰äº‹ä»¶&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;target&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ç›®æ ‡çŠ¶æ€&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;cond&quot;</span><span class="token operator">:</span> <span class="token string">&quot;æ¡ä»¶åˆ¤æ–­&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;actions&quot;</span><span class="token operator">:</span> <span class="token string">&quot;å¯æ‰§è¡Œå†…å®¹&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;in&quot;</span><span class="token operator">:</span> <span class="token string">&quot;åªèƒ½ä»è¿™ä¸ªçŠ¶æ€è¿‡æ¥&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;internal&quot;</span><span class="token operator">:</span> <span class="token string">&quot;å†…éƒ¨è½¬æ¢&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;meta&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç¤ºä¾‹ï¼š</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token function">Machine</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&quot;çŠ¶æ€æœº&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">states</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">æ‰“å¼€</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">on</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">ç‚¹å‡»</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">target</span><span class="token operator">:</span> <span class="token string">&quot;å…³é—­&quot;</span><span class="token punctuation">,</span>
          <span class="token function-variable function">cond</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">ctx<span class="token punctuation">,</span> event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> event<span class="token punctuation">.</span>data <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">å…³é—­</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="/blog/assets/1662726150855.63964666.webp" alt="" loading="lazy"></p><h3 id="_3-1-4-initial" tabindex="-1"><a class="header-anchor" href="#_3-1-4-initial" aria-hidden="true">#</a> 3.1.4 <code>&lt;initial&gt;</code></h3><p><code>&lt;initial&gt;</code>ï¼Œè¡¨ç¤ºå¤æ‚ <code>&lt;state&gt;</code> å…ƒç´ ï¼ˆå³åŒ…å«å­ <code>&lt;state&gt;</code> æˆ– <code>&lt;parallel&gt;</code> å…ƒç´ çš„å…ƒç´ ï¼‰çš„é»˜è®¤åˆå§‹çŠ¶æ€ã€‚å¹¶ä¸æ˜¯ä¸€ä¸ªçŠ¶æ€ï¼Œåªæ˜¯ä¸€ä¸ªæŒ‡å‘çŠ¶æ€çš„ä½œç”¨ã€‚</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scxml</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€æœº<span class="token punctuation">&quot;</span></span> <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1.0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2005/07/scxml<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>state</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>æ‰“å¼€<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>initial</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transition</span> <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>å†™å…¥<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>initial</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>state</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>å†™å…¥<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>state</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>è¯»å–<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>state</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scxml</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¿…é¡»å’Œ <code>&lt;transition&gt;</code> ä¸€èµ·ä½¿ç”¨ï¼Œè¿›è¡ŒçŠ¶æ€æŒ‡å®šã€‚</p><p>children åŒ…å« <code>&lt;transition&gt;</code>ã€‚</p><p>XState å¯ä»¥ç›´æ¥åœ¨ State Node çš„ <code>initail</code> è¿›è¡ŒæŒ‡å®šå®ç°ã€‚</p><p>ç¤ºä¾‹ï¼š</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token function">Machine</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&quot;çŠ¶æ€æœº&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">states</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">æ‰“å¼€</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">initial</span><span class="token operator">:</span> <span class="token string">&quot;è¯»å–&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">states</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">è¯»å–</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">å†™å…¥</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="/blog/assets/1662726180713.d1c01944.webp" alt="" loading="lazy"></p><h3 id="_3-1-5-parallel" tabindex="-1"><a class="header-anchor" href="#_3-1-5-parallel" aria-hidden="true">#</a> 3.1.5 <code>&lt;parallel&gt;</code></h3><p>è¯¥å…ƒç´ è¡¨ç¤ºä¸€ä¸ªçŠ¶æ€ï¼Œå…¶å­é¡¹å¹¶è¡Œæ‰§è¡Œã€‚å½“çˆ¶å…ƒç´ å¤„äºæ´»åŠ¨çŠ¶æ€æ—¶ï¼Œå­é¡¹åŒæ—¶å¤„äºæ´»åŠ¨çŠ¶æ€ã€‚</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scxml</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€æœº<span class="token punctuation">&quot;</span></span> <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1.0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2005/07/scxml<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parallel</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ç½‘ç›˜<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>state</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>å†™å…¥<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>state</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>è¯»å–<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parallel</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scxml</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å±æ€§å­—æ®µæè¿°å¦‚ä¸‹ï¼š</p><table><thead><tr><th>åç§°</th><th>å¿…å¡«</th><th>å±æ€§çº¦æŸ</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>æœ‰æ•ˆå€¼</th><th>æè¿°</th></tr></thead><tbody><tr><td>id</td><td>false</td><td>none</td><td>ID</td><td>none</td><td>XML Schema ä¸­å®šä¹‰çš„æœ‰æ•ˆ id</td><td>çŠ¶æ€ ID</td></tr></tbody></table><p>children å¯ä»¥åŒ…å«ï¼š</p><ul><li><code>&lt;onentry&gt;</code></li><li><code>&lt;onexit&gt;</code></li><li><code>&lt;transition&gt;</code></li><li><code>&lt;state&gt;</code></li><li><code>&lt;parallel&gt;</code></li><li><code>&lt;history&gt;</code></li><li><code>&lt;datamodel&gt;</code></li><li><code>&lt;invoke&gt;</code></li></ul><p>XState å¯ä»¥ç›´æ¥åœ¨ State Node çš„ <code>type: parallel</code> è¿›è¡ŒæŒ‡å®šå®ç°ã€‚</p><p>ç¤ºä¾‹ï¼š</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scxml</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€æœº<span class="token punctuation">&quot;</span></span> <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1.0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2005/07/scxml<span class="token punctuation">&quot;</span></span> <span class="token attr-name">initial</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ç½‘ç›˜<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parallel</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ç½‘ç›˜<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>state</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ä¸Šä¼ <span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>initial</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transition</span> <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ç©ºé—²<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>initial</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>state</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ç©ºé—²<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transition</span> <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ä¸Šä¼ ä¸­<span class="token punctuation">&quot;</span></span> <span class="token attr-name">event</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>å¼€å§‹<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>state</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>state</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ä¸Šä¼ ä¸­<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transition</span> <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>æˆåŠŸ<span class="token punctuation">&quot;</span></span> <span class="token attr-name">event</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>å®Œåœ¨<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>state</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>state</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>æˆåŠŸ<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>state</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>state</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>state</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ä¸‹è½½<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>initial</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transition</span> <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ä¸‹è½½.ç©ºé—²<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>initial</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>state</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ä¸‹è½½.ç©ºé—²<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transition</span> <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ä¸‹è½½.ä¸‹è½½ä¸­<span class="token punctuation">&quot;</span></span> <span class="token attr-name">event</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>å¼€å§‹<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>state</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>state</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ä¸‹è½½.ä¸‹è½½ä¸­<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transition</span> <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ä¸‹è½½.æˆåŠŸ<span class="token punctuation">&quot;</span></span> <span class="token attr-name">event</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>å®Œåœ¨<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>state</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>state</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ä¸‹è½½.æˆåŠŸ<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>state</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>state</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parallel</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scxml</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token function">Machine</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&quot;çŠ¶æ€æœº&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">initial</span><span class="token operator">:</span> <span class="token string">&quot;ç½‘ç›˜&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">states</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">ç½‘ç›˜</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;parallel&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">states</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">ä¸‹è½½</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">initial</span><span class="token operator">:</span> <span class="token string">&quot;ç©ºé—²&quot;</span><span class="token punctuation">,</span>
          <span class="token literal-property property">states</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">ç©ºé—²</span><span class="token operator">:</span> <span class="token punctuation">{</span>
              <span class="token literal-property property">on</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token literal-property property">å¼€å§‹</span><span class="token operator">:</span> <span class="token string">&quot;ä¸‹è½½ä¸­&quot;</span><span class="token punctuation">,</span>
              <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token literal-property property">ä¸‹è½½ä¸­</span><span class="token operator">:</span> <span class="token punctuation">{</span>
              <span class="token literal-property property">on</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token literal-property property">å®Œæˆ</span><span class="token operator">:</span> <span class="token string">&quot;æˆåŠŸ&quot;</span><span class="token punctuation">,</span>
              <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token literal-property property">æˆåŠŸ</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">ä¸Šä¼ </span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">initial</span><span class="token operator">:</span> <span class="token string">&quot;ç©ºé—²&quot;</span><span class="token punctuation">,</span>
          <span class="token literal-property property">states</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">ç©ºé—²</span><span class="token operator">:</span> <span class="token punctuation">{</span>
              <span class="token literal-property property">on</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token literal-property property">å¼€å§‹</span><span class="token operator">:</span> <span class="token string">&quot;ä¸Šä¼ ä¸­&quot;</span><span class="token punctuation">,</span>
              <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token literal-property property">ä¸Šä¼ ä¸­</span><span class="token operator">:</span> <span class="token punctuation">{</span>
              <span class="token literal-property property">on</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token literal-property property">å®Œæˆ</span><span class="token operator">:</span> <span class="token string">&quot;æˆåŠŸ&quot;</span><span class="token punctuation">,</span>
              <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token literal-property property">æˆåŠŸ</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="/blog/assets/1662726212898.64487297.webp" alt="" loading="lazy"></p><h3 id="_3-1-6-final" tabindex="-1"><a class="header-anchor" href="#_3-1-6-final" aria-hidden="true">#</a> 3.1.6 <code>&lt;final&gt;</code></h3><p><code>&lt;final&gt;</code> è¡¨ç¤º <code>&lt;scxml&gt;</code> æˆ–å¤åˆ <code>&lt;state&gt;</code> å…ƒç´ çš„æœ€ç»ˆçŠ¶æ€ã€‚</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scxml</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€æœº<span class="token punctuation">&quot;</span></span> <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1.0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2005/07/scxml<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>state</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ä¸‹è½½ä¸­<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transition</span> <span class="token attr-name">event</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>å®Œæˆ<span class="token punctuation">&quot;</span></span> <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>æˆåŠŸ<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>state</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>final</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>æˆåŠŸ<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scxml</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å±æ€§å­—æ®µæè¿°å¦‚ä¸‹ï¼š</p><table><thead><tr><th>åç§°</th><th>å¿…å¡«</th><th>å±æ€§çº¦æŸ</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>æœ‰æ•ˆå€¼</th><th>æè¿°</th></tr></thead><tbody><tr><td>id</td><td>false</td><td>none</td><td>ID</td><td>none</td><td>XML Schema ä¸­å®šä¹‰çš„æœ‰æ•ˆ id</td><td>çŠ¶æ€ ID</td></tr></tbody></table><p>children å¯ä»¥åŒ…å«ï¼š</p><ul><li><code>&lt;onentry&gt;</code></li><li><code>&lt;onexit&gt;</code></li><li><code>&lt;donedata&gt;</code></li></ul><p>XState å¯ä»¥ç›´æ¥åœ¨ State Node çš„ <code>type: final</code> è¿›è¡ŒæŒ‡å®šå®ç°ã€‚</p><p>ç¤ºä¾‹ï¼š</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scxml</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€æœº<span class="token punctuation">&quot;</span></span> <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1.0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2005/07/scxml<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>initial</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transition</span> <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>å·¥ä½œ<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>initial</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>state</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>å·¥ä½œ<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>initial</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transition</span> <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>æ­£åœ¨å®Œæˆä»»åŠ¡<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>initial</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- å­çŠ¶æ€ä¸º final æ—¶ï¼Œçˆ¶çŠ¶æ€è§¦å‘ don.state äº‹ä»¶ --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transition</span> <span class="token attr-name">event</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>done.state.å·¥ä½œ<span class="token punctuation">&quot;</span></span> <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>å·¥ä½œå®Œæˆ<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>state</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>æ­£åœ¨å®Œæˆä»»åŠ¡<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transition</span> <span class="token attr-name">event</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>å®Œæˆ<span class="token punctuation">&quot;</span></span> <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ä»»åŠ¡å®Œæˆ<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>state</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>final</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ä»»åŠ¡å®Œæˆ<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>final</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>state</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>final</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>å·¥ä½œå®Œæˆ<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scxml</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token function">Machine</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&quot;çŠ¶æ€æœº&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">initial</span><span class="token operator">:</span> <span class="token string">&quot;å·¥ä½œ&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">states</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">å·¥ä½œ</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">initial</span><span class="token operator">:</span> <span class="token string">&quot;æ­£åœ¨å®Œæˆä»»åŠ¡&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">states</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">æ­£åœ¨å®Œæˆä»»åŠ¡</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">on</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">å®Œæˆ</span><span class="token operator">:</span> <span class="token string">&quot;ä»»åŠ¡å®Œæˆ&quot;</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">ä»»åŠ¡å®Œæˆ</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;final&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token literal-property property">onDone</span><span class="token operator">:</span> <span class="token string">&quot;å·¥ä½œå®Œæˆ&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">å·¥ä½œå®Œæˆ</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="/blog/assets/1662726239563.3657261c.webp" alt="" loading="lazy"></p><h3 id="_3-1-7-history" tabindex="-1"><a class="header-anchor" href="#_3-1-7-history" aria-hidden="true">#</a> 3.1.7 <code>&lt;history&gt;</code></h3><p><code>&lt;history&gt;</code> ä¼ªçŠ¶æ€å…è®¸çŠ¶æ€æœºè®°ä½å®ƒçš„çŠ¶æ€é…ç½®ã€‚ä»¥ <code>&lt;history&gt;</code> çŠ¶æ€ä¸ºç›®æ ‡çš„ <code>&lt;transition&gt;</code> ä¼šå°†çŠ¶æ€æœºè¿”å›åˆ°æ­¤è®°å½•çš„é…ç½®ã€‚</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scxml</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€æœº<span class="token punctuation">&quot;</span></span> <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1.0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2005/07/scxml<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>history</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>å†å²çŠ¶æ€<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>shallow<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transition</span> <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€A<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>history</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>state</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€A<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>state</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scxml</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å±æ€§å­—æ®µæè¿°å¦‚ä¸‹ï¼š</p><table><thead><tr><th>åç§°</th><th>å¿…å¡«</th><th>å±æ€§çº¦æŸ</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>æœ‰æ•ˆå€¼</th><th>æè¿°</th></tr></thead><tbody><tr><td>id</td><td>false</td><td>none</td><td>ID</td><td>none</td><td>XML Schema ä¸­å®šä¹‰çš„æœ‰æ•ˆ id</td><td>çŠ¶æ€ ID</td></tr><tr><td>type</td><td>false</td><td>none</td><td>enum</td><td>&quot;shallow&quot;</td><td>&quot;deep&quot; æˆ– &quot;shallow&quot;</td><td>ç¡®å®šæ˜¯è®°å½•å½“å‰çŠ¶æ€çš„æ´»åŠ¨åŸå­å­çŠ¶æ€è¿˜æ˜¯ä»…è®°å½•å…¶ç›´æ¥æ´»åŠ¨å­çŠ¶æ€ã€‚</td></tr></tbody></table><p>children å¯ä»¥åŒ…å« <code>&lt;transition&gt;</code>ã€‚</p><p><code>&lt;transition&gt;</code> &#39;target&#39; æŒ‡å®šé»˜è®¤å†å²é…ç½®çš„è½¬æ¢ã€‚ ä»…å‘ç”Ÿä¸€æ¬¡ã€‚ åœ¨ç¬¦åˆæ ‡å‡†çš„ SCXML æ–‡æ¡£ä¸­ï¼Œæ­¤è½¬æ¢ä¸å¾—åŒ…å«â€œcondâ€æˆ–â€œäº‹ä»¶â€å±æ€§ï¼Œå¹¶ä¸”å¿…é¡»æŒ‡å®šä¸€ä¸ªéç©ºâ€œtargetâ€ã€‚æ­¤è½¬æ¢å¯èƒ½åŒ…å«å¯æ‰§è¡Œå†…å®¹ã€‚ å¦‚æœ &#39;type&#39; æ˜¯â€œshallowâ€ï¼Œé‚£ä¹ˆè¿™ä¸ª <code>&lt;transition&gt;</code> çš„ &#39;target&#39; å¿…é¡»åªåŒ…å«çˆ¶çŠ¶æ€çš„ç›´æ¥å­çº§ã€‚ å¦åˆ™ï¼Œå®ƒå¿…é¡»åªåŒ…å«çˆ¶çº§çš„åä»£ã€‚</p><p>XState å¯ä»¥ç›´æ¥åœ¨ State Node çš„ <code>type: history</code> è¿›è¡ŒæŒ‡å®šå®ç°ã€‚å¤šäº†ä¸€äº›é¢å¤–å±æ€§ï¼š</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;history&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;history&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shallow&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;target&quot;</span><span class="token operator">:</span> <span class="token string">&quot;é»˜è®¤æŒ‡å®šåˆ°çˆ¶çŠ¶æ€&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç¤ºä¾‹ï¼š</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scxml</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€æœº<span class="token punctuation">&quot;</span></span> <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1.0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2005/07/scxml<span class="token punctuation">&quot;</span></span> <span class="token attr-name">initial</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>æ–°å»º<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>state</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>æ–°å»º<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>initial</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transition</span> <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ç¼–å†™ä¸­<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>transition</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>initial</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transition</span> <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ä¸­æ–­<span class="token punctuation">&quot;</span></span> <span class="token attr-name">event</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>æš‚åœ<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>transition</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>state</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ç¼–å†™ä¸­<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transition</span> <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>é¢„è§ˆä¸­<span class="token punctuation">&quot;</span></span> <span class="token attr-name">event</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ä¸‹ä¸€æ­¥<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>transition</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>state</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>state</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>é¢„è§ˆä¸­<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transition</span> <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>æäº¤ä¸­<span class="token punctuation">&quot;</span></span> <span class="token attr-name">event</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ä¸‹ä¸€æ­¥<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>transition</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>state</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>state</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>æäº¤ä¸­<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>state</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>history</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>å†å²çŠ¶æ€<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>shallow<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>history</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>state</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>state</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ä¸­æ–­<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transition</span> <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>å†å²çŠ¶æ€<span class="token punctuation">&quot;</span></span> <span class="token attr-name">event</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>æ¢å¤<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>transition</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>state</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scxml</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token function">Machine</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&quot;çŠ¶æ€æœº&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">initial</span><span class="token operator">:</span> <span class="token string">&quot;æ–°å»º&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">states</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">æ–°å»º</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">initial</span><span class="token operator">:</span> <span class="token string">&quot;ç¼–å†™ä¸­&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">on</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">æš‚åœ</span><span class="token operator">:</span> <span class="token string">&quot;ä¸­æ–­&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token literal-property property">states</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">ç¼–å†™ä¸­</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">on</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">ä¸‹ä¸€æ­¥</span><span class="token operator">:</span> <span class="token string">&quot;é¢„è§ˆä¸­&quot;</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">é¢„è§ˆä¸­</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">on</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">ä¸‹ä¸€æ­¥</span><span class="token operator">:</span> <span class="token string">&quot;æäº¤ä¸­&quot;</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">æäº¤ä¸­</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">å†å²çŠ¶æ€</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;history&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">ä¸­æ–­</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">on</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">æ¢å¤</span><span class="token operator">:</span> <span class="token string">&quot;æ–°å»º.å†å²çŠ¶æ€&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="/blog/assets/1662726294380.3d4f18ad.webp" alt="" loading="lazy"></p><h3 id="_3-1-8-onentry" tabindex="-1"><a class="header-anchor" href="#_3-1-8-onentry" aria-hidden="true">#</a> 3.1.8 <code>&lt;onentry&gt;</code></h3><p><code>&lt;onentry&gt;</code>ï¼Œä¸€ä¸ªåŒ…è£…å…ƒç´ ï¼ŒåŒ…å«è¿›å…¥çŠ¶æ€æ—¶è¦æ‰§è¡Œçš„å¯æ‰§è¡Œå†…å®¹ã€‚</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scxml</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€æœº<span class="token punctuation">&quot;</span></span> <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1.0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2005/07/scxml<span class="token punctuation">&quot;</span></span> <span class="token attr-name">initial</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€A<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>state</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€A<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>onentry</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>log</span> <span class="token attr-name">expr</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&#39;</span>æ¬¢è¿è¿›å…¥çŠ¶æ€A&#39;<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>onentry</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>state</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scxml</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åŒ <code>&lt;transition&gt;</code>ï¼Œchildren åªèƒ½åŒ…å« å¯æ‰§è¡Œå†…å®¹ã€‚</p><p>XState å¯ä»¥ç›´æ¥åœ¨ State Node çš„ <code>onEntry</code> è¿›è¡Œå®šä¹‰ã€‚</p><p>ç¤ºä¾‹ï¼š</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token function">Machine</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&quot;çŠ¶æ€æœº&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">initial</span><span class="token operator">:</span> <span class="token string">&quot;çŠ¶æ€A&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">states</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    çŠ¶æ€<span class="token constant">A</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">onEntry</span><span class="token operator">:</span> actions<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;æ¬¢è¿è¿›å…¥çŠ¶æ€A&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="/blog/assets/1662726319635.fa2fbbf3.webp" alt="" loading="lazy"></p><h3 id="_3-1-9-onexit" tabindex="-1"><a class="header-anchor" href="#_3-1-9-onexit" aria-hidden="true">#</a> 3.1.9 <code>&lt;onexit&gt;</code></h3><p><code>&lt;onexit&gt;</code>ï¼Œä¸€ä¸ªåŒ…è£…å…ƒç´ ï¼ŒåŒ…å«é€€å‡ºçŠ¶æ€æ—¶è¦æ‰§è¡Œçš„å¯æ‰§è¡Œå†…å®¹ã€‚</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scxml</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€æœº<span class="token punctuation">&quot;</span></span> <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1.0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2005/07/scxml<span class="token punctuation">&quot;</span></span> <span class="token attr-name">initial</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€A<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>state</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€A<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>onexit</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>log</span> <span class="token attr-name">expr</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&#39;</span>æ¬¢è¿ä¸‹æ¬¡å†æ¥çŠ¶æ€A&#39;<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>onexit</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>state</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scxml</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åŒ <code>&lt;transition&gt;</code>ï¼Œchildren åªèƒ½åŒ…å« å¯æ‰§è¡Œå†…å®¹ã€‚</p><p>XState å¯ä»¥ç›´æ¥åœ¨ State Node çš„ <code>onExit</code> è¿›è¡Œå®šä¹‰ã€‚</p><p>ç¤ºä¾‹ï¼š</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token function">Machine</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&quot;çŠ¶æ€æœº&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">initial</span><span class="token operator">:</span> <span class="token string">&quot;çŠ¶æ€A&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">states</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    çŠ¶æ€<span class="token constant">A</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">onExit</span><span class="token operator">:</span> actions<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;æ¬¢è¿ä¸‹æ¬¡å†æ¥çŠ¶æ€A&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="/blog/assets/1662726354370.18efe4f1.webp" alt="" loading="lazy"></p><h2 id="_3-2-å¯æ‰§è¡Œå†…å®¹" tabindex="-1"><a class="header-anchor" href="#_3-2-å¯æ‰§è¡Œå†…å®¹" aria-hidden="true">#</a> 3.2 å¯æ‰§è¡Œå†…å®¹</h2><p>å¯æ‰§è¡Œå†…å®¹ï¼Œåªèƒ½åœ¨ <code>&lt;onentry&gt;</code>ã€<code>&lt;onexit&gt;</code> å’Œ <code>&lt;transition&gt;</code> ä¸­ä½¿ç”¨ã€‚å®ƒæä¾›äº†å…è®¸ SCXML ä¼šè¯ä¿®æ”¹å…¶æ•°æ®æ¨¡å‹å¹¶ä¸å¤–éƒ¨å®ä½“äº¤äº’çš„é’©å­ã€‚</p><p>ä¸ä»…åŒ…æ‹¬äº† <code>&lt;raise&gt;</code>ã€<code>&lt;foreach&gt;</code>ã€<code>&lt;log&gt;</code>ã€<code>&lt;if&gt;</code>ã€<code>&lt;elseif&gt;</code>ã€<code>&lt;else&gt;</code>ï¼Œè¿˜åŒ…å«äº†å…¶ä»–åˆ†ç»„ä¸‹çš„ <code>&lt;script&gt;</code> ã€<code>&lt;assign&gt;</code>ã€<code>&lt;send&gt;</code> ã€<code>&lt;cancel&gt;</code>ã€‚å½“ç„¶ ä¸‹é¢æˆ‘ä»¬è¿˜æ˜¯æŒ‰ç…§è§„èŒƒæ–‡æ¡£ä¸­çš„åˆ†ç±»è¿›è¡Œå¯¹åº”è¯´æ˜ã€‚</p><p>åœ¨ XState ä¸­ï¼Œæ‰€æœ‰çš„åœ¨ SCXML ä¸­çš„â€œå¯æ‰§è¡Œå†…å®¹â€ç»Ÿç§°ä¸º actionã€‚æ‰€ä»¥å¯¹åº”çš„è¿™äº›â€œå¯æ‰§è¡Œå†…å®¹â€éƒ½åœ¨ XState çš„ actions åŒ…ä¸­ã€‚</p><h3 id="_3-2-1-raise" tabindex="-1"><a class="header-anchor" href="#_3-2-1-raise" aria-hidden="true">#</a> 3.2.1 <code>&lt;raise&gt;</code></h3><p><code>&lt;raise&gt;</code> å…ƒç´ åœ¨å½“å‰ SCXML ä¼šè¯ä¸­å¼•å‘ä¸€ä¸ªäº‹ä»¶ã€‚å¯ä»¥è§¦å‘ <code>&lt;transition&gt;</code> ä¸­çš„ eventã€‚</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scxml</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€æœº<span class="token punctuation">&quot;</span></span> <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1.0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2005/07/scxml<span class="token punctuation">&quot;</span></span> <span class="token attr-name">initial</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€A<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>state</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€A<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>onentry</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>raise</span> <span class="token attr-name">event</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>è·³è½¬<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>onentry</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>state</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scxml</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å±æ€§å­—æ®µæè¿°å¦‚ä¸‹ï¼š</p><table><thead><tr><th>åç§°</th><th>å¿…å¡«</th><th>å±æ€§çº¦æŸ</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>æœ‰æ•ˆå€¼</th><th>æè¿°</th></tr></thead><tbody><tr><td>event</td><td>true</td><td></td><td>NMTOKEN</td><td>none</td><td></td><td>æŒ‡å®šäº‹ä»¶çš„åç§°ã€‚è¿™å°†ä¸è½¬æ¢çš„â€œeventâ€å±æ€§ç›¸åŒ¹é…ã€‚</td></tr></tbody></table><p>å¯¹åº” XState çš„ <code>actions.raise</code> å‡½æ•°ã€‚ç¤ºä¾‹ï¼š</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scxml</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€æœº<span class="token punctuation">&quot;</span></span> <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1.0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2005/07/scxml<span class="token punctuation">&quot;</span></span> <span class="token attr-name">initial</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€A<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>state</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€A<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transition</span> <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€B<span class="token punctuation">&quot;</span></span> <span class="token attr-name">event</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>è·³è½¬<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>transition</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>onentry</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>raise</span> <span class="token attr-name">event</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>è·³è½¬<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>onentry</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>state</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>state</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€B<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>state</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scxml</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token function">Machine</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&quot;çŠ¶æ€æœº&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">initial</span><span class="token operator">:</span> <span class="token string">&quot;çŠ¶æ€A&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">states</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    çŠ¶æ€<span class="token constant">A</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">onEntry</span><span class="token operator">:</span> actions<span class="token punctuation">.</span><span class="token function">raise</span><span class="token punctuation">(</span><span class="token string">&quot;è·³è½¬&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token literal-property property">on</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">è·³è½¬</span><span class="token operator">:</span> <span class="token string">&quot;çŠ¶æ€B&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    çŠ¶æ€<span class="token constant">B</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="/blog/assets/1662726381568.6f174e47.webp" alt="" loading="lazy"></p><h3 id="_3-2-2-foreach" tabindex="-1"><a class="header-anchor" href="#_3-2-2-foreach" aria-hidden="true">#</a> 3.2.2 <code>&lt;foreach&gt;</code></h3><p><code>&lt;foreach&gt;</code> å…ƒç´ å…è®¸ SCXML åº”ç”¨ç¨‹åºéå† <code>&lt;datamodel&gt;</code> ä¸­çš„é›†åˆï¼Œå¹¶ä¸ºé›†åˆä¸­çš„æ¯ä¸ªé¡¹ç›®æ‰§è¡Œå…¶ä¸­åŒ…å«çš„ å¯æ‰§è¡Œå†…å®¹ã€‚</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scxml</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€æœº<span class="token punctuation">&quot;</span></span> <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1.0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2005/07/scxml<span class="token punctuation">&quot;</span></span> <span class="token attr-name">initial</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€A<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>datamodel</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>data</span> <span class="token attr-name">expr</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>[ 10, 20, 30 ]<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dataArr<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>datamodel</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>state</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€A<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>onentry</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>foreach</span> <span class="token attr-name">array</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dataArr<span class="token punctuation">&quot;</span></span> <span class="token attr-name">index</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>varIndex<span class="token punctuation">&quot;</span></span> <span class="token attr-name">item</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>varItem<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>log</span> <span class="token attr-name">expr</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>varIndex<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>log</span> <span class="token attr-name">expr</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>varItem<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>foreach</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>onentry</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>state</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scxml</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å±æ€§å­—æ®µæè¿°å¦‚ä¸‹ï¼š</p><table><thead><tr><th>åç§°</th><th>å¿…å¡«</th><th>å±æ€§çº¦æŸ</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>æœ‰æ•ˆå€¼</th><th>æè¿°</th></tr></thead><tbody><tr><td>array</td><td>true</td><td></td><td>Value expression</td><td>none</td><td>è®¡ç®—ç»“æœä¸ºå¯è¿­ä»£é›†åˆçš„å€¼è¡¨è¾¾å¼ <code>&lt;foreach&gt;</code></td><td>å…ƒç´ å°†éå†æ­¤é›†åˆçš„æµ…è¡¨å‰¯æœ¬</td></tr><tr><td>item</td><td>true</td><td></td><td>xsd:string</td><td>none</td><td>åœ¨æŒ‡å®šæ•° <code>&lt;datamodel&gt;</code> ä¸­æœ‰æ•ˆçš„ä»»ä½•å˜é‡å</td><td>åœ¨å¾ªç¯çš„æ¯æ¬¡è¿­ä»£ä¸­å­˜å‚¨é›†åˆçš„ä¸åŒé¡¹çš„å˜é‡</td></tr><tr><td>index</td><td>false</td><td></td><td>xsd:string</td><td>none</td><td>åœ¨æŒ‡å®šæ•° <code>&lt;datamodel&gt;</code> ä¸­æœ‰æ•ˆçš„ä»»ä½•å˜é‡å</td><td>åœ¨ foreach å¾ªç¯çš„æ¯æ¬¡è¿­ä»£ä¸­å­˜å‚¨å½“å‰è¿­ä»£ç´¢å¼•çš„å˜é‡</td></tr></tbody></table><p>children ç”±ä¸€ä¸ªæˆ–å¤šä¸ª å¯æ‰§è¡Œå†…å®¹ç»„æˆã€‚</p><p>å¯ä»¥å¯¹åº” XState çš„ <code>actions.pure</code> å‡½æ•°ï¼Œå®ƒä¹Ÿå¯ä»¥è¿”å›ä¸€ä¸ªæˆ–è€…ä¸€ç»„ actionï¼Œæˆ–è€…ä»€ä¹ˆä¹Ÿä¸è¿”å›ã€‚å½“ç„¶è¿™ä¸ªå‡½æ•°æ›´çµæ´»ã€‚ç¤ºä¾‹ï¼š</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token function">Machine</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&quot;çŠ¶æ€æœº&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">initial</span><span class="token operator">:</span> <span class="token string">&quot;çŠ¶æ€A&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">context</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">dataArr</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">states</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    çŠ¶æ€<span class="token constant">A</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">onEntry</span><span class="token operator">:</span> actions<span class="token punctuation">.</span><span class="token function">pure</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">context<span class="token punctuation">,</span> event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> _actions <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

        context<span class="token punctuation">.</span>dataArr<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">varItem<span class="token punctuation">,</span> varIndex</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          _actions<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>actions<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>varIndex<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          _actions<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>actions<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>varItem<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> _actions<span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="/blog/assets/1662726420494.d05e4f04.webp" alt="" loading="lazy"></p><h3 id="_3-2-3-log" tabindex="-1"><a class="header-anchor" href="#_3-2-3-log" aria-hidden="true">#</a> 3.2.3 <code>&lt;log&gt;</code></h3><p><code>&lt;log&gt;</code> å…è®¸åº”ç”¨ç¨‹åºç”Ÿæˆæ—¥å¿—è®°å½•æˆ–è°ƒè¯•æ¶ˆæ¯ã€‚</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scxml</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€æœº<span class="token punctuation">&quot;</span></span> <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1.0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2005/07/scxml<span class="token punctuation">&quot;</span></span> <span class="token attr-name">initial</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€A<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>state</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€A<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>onentry</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>log</span> <span class="token attr-name">expr</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&#39;</span>æ¬¢è¿è¿›å…¥çŠ¶æ€A&#39;<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>onentry</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>state</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scxml</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å±æ€§å­—æ®µæè¿°å¦‚ä¸‹ï¼š</p><table><thead><tr><th>åç§°</th><th>å¿…å¡«</th><th>å±æ€§çº¦æŸ</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>æœ‰æ•ˆå€¼</th><th>æè¿°</th></tr></thead><tbody><tr><td>label</td><td>false</td><td></td><td>string</td><td>ç©ºå­—ç¬¦ä¸²</td><td></td><td>å…·æœ‰ä¾èµ–äºå®ç°çš„è§£é‡Šçš„å­—ç¬¦ä¸²ã€‚å®ƒæ—¨åœ¨æä¾›æœ‰å…³â€œexprâ€æŒ‡å®šçš„æ—¥å¿—å­—ç¬¦ä¸²çš„å…ƒæ•°æ®ã€‚</td></tr><tr><td>expr</td><td>false</td><td></td><td>å€¼è¡¨è¾¾å¼</td><td>none</td><td></td><td>è¿”å›è¦è®°å½•çš„å€¼çš„è¡¨è¾¾å¼</td></tr></tbody></table><p>å¯¹åº” XState çš„ <code>actions.log</code>ã€‚ç¤ºä¾‹ï¼š</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token function">Machine</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&quot;çŠ¶æ€æœº&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">initial</span><span class="token operator">:</span> <span class="token string">&quot;çŠ¶æ€A&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">states</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    çŠ¶æ€<span class="token constant">A</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">onEntry</span><span class="token operator">:</span> actions<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;æ¬¢è¿è¿›å…¥çŠ¶æ€A&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="/blog/assets/1662726319635.fa2fbbf3.webp" alt="" loading="lazy"></p><h3 id="_3-2-4-if-ã€-elseif-ã€-else" tabindex="-1"><a class="header-anchor" href="#_3-2-4-if-ã€-elseif-ã€-else" aria-hidden="true">#</a> 3.2.4 <code>&lt;if&gt;</code>ã€<code>&lt;elseif&gt;</code>ã€<code>&lt;else&gt;</code></h3><p><code>&lt;if&gt;</code> æ˜¯æ¡ä»¶æ‰§è¡Œå…ƒç´ çš„å®¹å™¨ã€‚ <code>&lt;elseif&gt;</code> æ˜¯ä¸€ä¸ªç©ºå…ƒç´ ï¼Œå®ƒå¯¹ <code>&lt;if&gt;</code> çš„å†…å®¹è¿›è¡Œåˆ†åŒºï¼Œå¹¶æä¾›ä¸€ä¸ªåˆ¤æ–­æ˜¯å¦æ‰§è¡Œåˆ†åŒºçš„æ¡ä»¶ã€‚ <code>&lt;else&gt;</code> æ˜¯ä¸€ä¸ªç©ºå…ƒç´ ï¼Œç”¨äºåˆ’åˆ† <code>&lt;if&gt;</code> çš„å†…å®¹ã€‚å®ƒç­‰ä»·äºä¸€ä¸ªå¸¦æœ‰â€œcondâ€çš„ <code>&lt;elseif&gt;</code>ï¼Œå®ƒæ€»æ˜¯è®¡ç®—ä¸ºçœŸã€‚</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">cond</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>cond1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>log</span> <span class="token attr-name">expr</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&#39;</span>cond1==true&#39;<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>elseif</span> <span class="token attr-name">cond</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>cond2<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>log</span> <span class="token attr-name">expr</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&#39;</span>cond2==true&#39;<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>elseif</span> <span class="token attr-name">cond</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>cond3<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>log</span> <span class="token attr-name">expr</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&#39;</span>cond3==true&#39;<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>else</span> <span class="token punctuation">/&gt;</span></span>
  	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>log</span> <span class="token attr-name">expr</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&#39;</span>å…¶ä»–æƒ…å†µ&#39;<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å±æ€§å­—æ®µæè¿°å¦‚ä¸‹ï¼š</p><table><thead><tr><th>åç§°</th><th>å¿…å¡«</th><th>å±æ€§çº¦æŸ</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>æœ‰æ•ˆå€¼</th><th>æè¿°</th></tr></thead><tbody><tr><td>cond</td><td>true</td><td></td><td>æ¡ä»¶è¡¨è¾¾å¼</td><td>none</td><td>æœ‰æ•ˆçš„æ¡ä»¶è¡¨è¾¾å¼</td><td>ä¸€ä¸ªå¸ƒå°”è¡¨è¾¾å¼</td></tr></tbody></table><p>XState ä¸­æœ‰å¾ˆå¤šæ–¹æ³•å¯ä»¥å®ç°ç±»ä¼¼çš„èƒ½åŠ›ï¼Œå¦‚æœéè¦å¯¹æ ‡çš„è¯å°±æ˜¯ <code>actions.choose</code> å‡½æ•°äº†ã€‚ç¤ºä¾‹ï¼š</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scxml</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€æœº<span class="token punctuation">&quot;</span></span> <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1.0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2005/07/scxml<span class="token punctuation">&quot;</span></span> <span class="token attr-name">initial</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€A<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>datamodel</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>data</span> <span class="token attr-name">expr</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>value<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>datamodel</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>state</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€A<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>onentry</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">cond</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>value == 1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>log</span> <span class="token attr-name">expr</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&#39;</span>value === 1&#39;<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>

        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>elseif</span> <span class="token attr-name">cond</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>value == 2<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>log</span> <span class="token attr-name">expr</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&#39;</span>value === 2&#39;<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>

        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>else</span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>log</span> <span class="token attr-name">expr</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&#39;</span>value != 1 &amp;&amp; value != 2&#39;<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>onentry</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>state</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scxml</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token function">Machine</span><span class="token punctuation">(</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&quot;çŠ¶æ€æœº&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">initial</span><span class="token operator">:</span> <span class="token string">&quot;çŠ¶æ€A&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">context</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">states</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      çŠ¶æ€<span class="token constant">A</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">onEntry</span><span class="token operator">:</span> actions<span class="token punctuation">.</span><span class="token function">choose</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            <span class="token function-variable function">cond</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">context<span class="token punctuation">,</span> event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> context<span class="token punctuation">.</span>value <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token literal-property property">actions</span><span class="token operator">:</span> <span class="token punctuation">[</span>actions<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;value === 1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span>
            <span class="token literal-property property">cond</span><span class="token operator">:</span> <span class="token string">&quot;equal2&quot;</span><span class="token punctuation">,</span>
            <span class="token literal-property property">actions</span><span class="token operator">:</span> <span class="token punctuation">[</span>actions<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;value === 2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span>
            <span class="token literal-property property">actions</span><span class="token operator">:</span> <span class="token punctuation">[</span>actions<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;value != 1 &amp;&amp; value != 2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">guards</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token function-variable function">equal2</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">context</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> context<span class="token punctuation">.</span>value <span class="token operator">===</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="/blog/assets/1662726481551.ac080a18.webp" alt="" loading="lazy"></p><h2 id="_3-3-æ•°æ®æ¨¡å‹å’Œæ•°æ®æ“ä½œ" tabindex="-1"><a class="header-anchor" href="#_3-3-æ•°æ®æ¨¡å‹å’Œæ•°æ®æ“ä½œ" aria-hidden="true">#</a> 3.3 æ•°æ®æ¨¡å‹å’Œæ•°æ®æ“ä½œ</h2><p>è¿™éƒ¨åˆ†æ˜¯çŠ¶æ€ä¹‹å¤–çš„æ•°æ®éƒ¨åˆ†çš„å®šä¹‰å’Œæ“ä½œã€‚</p><p>æ•°æ®æ¨¡å‹é€šè¿‡ <code>&lt;datamodel&gt;</code> å…ƒç´ å®šä¹‰ï¼Œè¯¥å…ƒç´ åŒ…å«é›¶ä¸ªæˆ–å¤šä¸ª <code>&lt;data&gt;</code> å…ƒç´ ï¼Œæ¯ä¸ªå…ƒç´ å®šä¹‰ä¸€ä¸ªæ•°æ®å…ƒç´ å¹¶ä¸ºå…¶åˆ†é…ä¸€ä¸ªåˆå§‹å€¼ã€‚ è¿™äº›å€¼å¯ä»¥åœ¨çº¿æŒ‡å®šæˆ–ä»å¤–éƒ¨æºåŠ è½½ã€‚ ç„¶åå¯ä»¥é€šè¿‡ <code>&lt;assign&gt;</code> å…ƒç´ æ›´æ–°å®ƒä»¬ã€‚ <code>&lt;donedata&gt;</code>ã€<code>&lt;content&gt;</code> å’Œ <code>&lt;param&gt;</code> å…ƒç´ å¯ç”¨äºå°†æ•°æ®åˆå¹¶åˆ°ä¸å¤–éƒ¨å®ä½“çš„é€šä¿¡ä¸­ã€‚ æœ€åï¼Œ<code>&lt;script&gt;</code> å…ƒç´ å…è®¸ç»“åˆè„šæœ¬ã€‚</p><h3 id="_3-3-1-datamodel" tabindex="-1"><a class="header-anchor" href="#_3-3-1-datamodel" aria-hidden="true">#</a> 3.3.1 <code>&lt;datamodel&gt;</code></h3><p><code>&lt;datamodel&gt;</code> æ˜¯ä¸€ä¸ªåŒ…è£…å™¨å…ƒç´ ï¼Œå®ƒå°è£…äº†ä»»æ„æ•°é‡çš„ <code>&lt;data&gt;</code> å…ƒç´ ï¼Œæ¯ä¸ªå…ƒç´ éƒ½å®šä¹‰äº†ä¸€ä¸ªæ•°æ®å¯¹è±¡ã€‚</p><p>children åªèƒ½åŒ…å« <code>&lt;data&gt;</code>ã€‚</p><p>å¯¹åº” XState çš„é¡¶å±‚ <code>context</code>ã€‚</p><h3 id="_3-3-2-data" tabindex="-1"><a class="header-anchor" href="#_3-3-2-data" aria-hidden="true">#</a> 3.3.2 <code>&lt;data&gt;</code></h3><p><code>&lt;data&gt;</code> å…ƒç´ ç”¨äºå£°æ˜å’Œå¡«å……æ•°æ®æ¨¡å‹çš„éƒ¨åˆ†ã€‚</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>datamodel</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>data</span> <span class="token attr-name">expr</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>VarBool<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>data</span> <span class="token attr-name">expr</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>VarInt<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>data</span> <span class="token attr-name">expr</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&#39;</span>è¿™æ˜¯å­—ç¬¦ä¸²&#39;<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>VarString<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>datamodel</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å±æ€§å­—æ®µæè¿°å¦‚ä¸‹ï¼š</p><table><thead><tr><th>åç§°</th><th>å¿…å¡«</th><th>å±æ€§çº¦æŸ</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>æœ‰æ•ˆå€¼</th><th>æè¿°</th></tr></thead><tbody><tr><td>id</td><td>true</td><td></td><td>ID</td><td>none</td><td></td><td>æ•°æ®é¡¹çš„åç§°</td></tr><tr><td>src</td><td>false</td><td></td><td>URI</td><td>none</td><td></td><td>ç»™å‡ºåº”ä»ä¸­è·å–æ•°æ®å¯¹è±¡çš„ä½ç½®</td></tr><tr><td>expr</td><td>false</td><td></td><td>Expression</td><td>none</td><td>æœ‰æ•ˆçš„æ¡ä»¶è¡¨è¾¾å¼</td><td>æ‰§è¡Œä»¥æä¾›æ•°æ®é¡¹çš„å€¼</td></tr></tbody></table><p>åœ¨ç¬¦åˆæ ‡å‡†çš„ SCXML æ–‡æ¡£ä¸­ï¼Œ<code>&lt;data&gt;</code> å…ƒç´ å¯ä»¥å…·æœ‰â€œsrcâ€æˆ–â€œexprâ€å±æ€§ï¼Œä½†ä¸èƒ½ åŒæ—¶å…·æœ‰ã€‚æ­¤å¤–ï¼Œå¦‚æœä»»ä¸€å±æ€§å­˜åœ¨ï¼Œ<code>&lt;data&gt;</code> å…ƒç´  ç»ä¸èƒ½æœ‰ childrenã€‚å› æ­¤ï¼Œ&#39;src&#39;ã€&#39;expr&#39; å’Œ children åœ¨ <code>&lt;data&gt;</code> å…ƒç´ ä¸­æ˜¯äº’æ–¥çš„ã€‚</p><p>åœ¨ XState ä¸­ç›´æ¥ä½œä¸º <code>context</code> å­—æ®µçš„å€¼å­˜åœ¨ã€‚</p><p>ç¤ºä¾‹ï¼š</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scxml</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€æœº<span class="token punctuation">&quot;</span></span> <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1.0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2005/07/scxml<span class="token punctuation">&quot;</span></span> <span class="token attr-name">initial</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€A<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>datamodel</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>data</span> <span class="token attr-name">expr</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>VarBool<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>data</span> <span class="token attr-name">expr</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>VarInt<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>data</span> <span class="token attr-name">expr</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&#39;</span>è¿™æ˜¯å­—ç¬¦ä¸²&#39;<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>VarString<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>datamodel</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>state</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€A<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>onentry</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>log</span> <span class="token attr-name">expr</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>VarBool<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>log</span> <span class="token attr-name">expr</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>VarInt<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>log</span> <span class="token attr-name">expr</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>VarString<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>onentry</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>state</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scxml</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token function">Machine</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&quot;çŠ¶æ€æœº&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">initial</span><span class="token operator">:</span> <span class="token string">&quot;çŠ¶æ€A&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">context</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">varBool</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token literal-property property">varInt</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token literal-property property">varString</span><span class="token operator">:</span> <span class="token string">&quot;è¿™æ˜¯å­—ç¬¦ä¸²&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">states</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    çŠ¶æ€<span class="token constant">A</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">onEntry</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        actions<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">context</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> context<span class="token punctuation">.</span>varBool<span class="token punctuation">)</span><span class="token punctuation">,</span>
        actions<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">context</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> context<span class="token punctuation">.</span>varInt<span class="token punctuation">)</span><span class="token punctuation">,</span>
        actions<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">context</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> context<span class="token punctuation">.</span>varString<span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="/blog/assets/1662726509775.632efee1.webp" alt="" loading="lazy"></p><h3 id="_3-3-3-assign" tabindex="-1"><a class="header-anchor" href="#_3-3-3-assign" aria-hidden="true">#</a> 3.3.3 <code>&lt;assign&gt;</code></h3><p><code>&lt;assign&gt;</code> å…ƒç´ ç”¨äºä¿®æ”¹æ•°æ®æ¨¡å‹ã€‚</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>assign</span> <span class="token attr-name">location</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Var1<span class="token punctuation">&quot;</span></span> <span class="token attr-name">expr</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>5<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>å±æ€§å­—æ®µæè¿°å¦‚ä¸‹ï¼š</p><table><thead><tr><th>åç§°</th><th>å¿…å¡«</th><th>å±æ€§çº¦æŸ</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>æœ‰æ•ˆå€¼</th><th>æè¿°</th></tr></thead><tbody><tr><td>location</td><td>true</td><td></td><td>è·¯å¾„è¡¨è¾¾å¼</td><td>none</td><td>æœ‰æ•ˆçš„è·¯å¾„è¡¨è¾¾å¼</td><td>æ•°æ®æ¨¡å‹ä¸­è¦æ’å…¥æ–°å€¼çš„ä½ç½®</td></tr><tr><td>expr</td><td>false</td><td>æ­¤å±æ€§ä¸å¾—å‡ºç°åœ¨å…·æœ‰å­å…ƒç´ çš„ <code>&lt;assign&gt;</code> å…ƒç´ ä¸­</td><td>å€¼è¡¨è¾¾</td><td>none</td><td>æœ‰æ•ˆçš„å€¼è¡¨è¾¾å¼</td><td>è¿”å›è¦åˆ†é…çš„å€¼çš„è¡¨è¾¾å¼</td></tr></tbody></table><p>åœ¨ XState ä¸­ç”¨ <code>actions.assign</code> å‡½æ•°è¡¨ç¤ºã€‚</p><p>ç¤ºä¾‹ï¼š</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scxml</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€æœº<span class="token punctuation">&quot;</span></span> <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1.0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2005/07/scxml<span class="token punctuation">&quot;</span></span> <span class="token attr-name">initial</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€A<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>datamodel</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>data</span> <span class="token attr-name">expr</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>VarInt<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>data</span> <span class="token attr-name">expr</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&#39;</span>è¿™æ˜¯å­—ç¬¦ä¸²&#39;<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>VarString<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>datamodel</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>state</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€A<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>onentry</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>assign</span> <span class="token attr-name">expr</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>5<span class="token punctuation">&quot;</span></span> <span class="token attr-name">location</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>VarInt<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>assign</span> <span class="token attr-name">expr</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&#39;</span>æ–°çš„å­—ç¬¦ä¸²&#39;<span class="token punctuation">&quot;</span></span> <span class="token attr-name">location</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>VarString<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>onentry</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>state</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scxml</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token function">Machine</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&quot;çŠ¶æ€æœº&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">initial</span><span class="token operator">:</span> <span class="token string">&quot;çŠ¶æ€A&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">context</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">varInt</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token literal-property property">varString</span><span class="token operator">:</span> <span class="token string">&quot;è¿™æ˜¯å­—ç¬¦ä¸²&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">states</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    çŠ¶æ€<span class="token constant">A</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">onEntry</span><span class="token operator">:</span> actions<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">varInt</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
        <span class="token literal-property property">varString</span><span class="token operator">:</span> <span class="token string">&quot;æ–°çš„å­—ç¬¦ä¸²&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="/blog/assets/1662726535295.b8550ed6.webp" alt="" loading="lazy"></p><h3 id="_3-3-4-script" tabindex="-1"><a class="header-anchor" href="#_3-3-4-script" aria-hidden="true">#</a> 3.3.4 <code>&lt;script&gt;</code></h3><p><code>&lt;script&gt;</code> å…ƒç´ å°†è„šæœ¬åŠŸèƒ½æ·»åŠ åˆ°çŠ¶æ€æœºã€‚</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span>console.log(&#39;Hello, world!&#39;)<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>å±æ€§å­—æ®µæè¿°å¦‚ä¸‹ï¼š</p><table><thead><tr><th>åç§°</th><th>å¿…å¡«</th><th>å±æ€§çº¦æŸ</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>æœ‰æ•ˆå€¼</th><th>æè¿°</th></tr></thead><tbody><tr><td>src</td><td>false</td><td>å¦‚æœå…ƒç´ æœ‰å­å…ƒç´ ï¼Œåˆ™å¯èƒ½ä¸ä¼šå‘ç”Ÿ</td><td></td><td>none</td><td>æœ‰æ•ˆçš„ URI</td><td>ç»™å‡ºåº”è¯¥ä¸‹è½½è„šæœ¬çš„ä½ç½®</td></tr></tbody></table><p><code>&lt;script&gt;</code> å…ƒç´ çš„ children å†…å®¹è¡¨ç¤ºè¦æ‰§è¡Œçš„è„šæœ¬ä»£ç ã€‚</p><p>XState åœ¨å¾ˆå¤šåœ°æ–¹å¯ä»¥è¡¨è¾¾ç±»ä¼¼çš„èƒ½åŠ›ï¼Œå¦‚ actions å±æ€§æ˜¯æ”¯æŒç›´æ¥èµ‹å€¼å‡½æ•°çš„ï¼Œåœ¨ <code>actions.log</code>ã€<code>actions.pure</code>ã€<code>actions.assign</code> ç­‰å‡½æ•°éƒ½å¯ä»¥å®ç°ç±»ä¼¼èƒ½åŠ›ã€‚</p><h3 id="_3-3-5-donedata" tabindex="-1"><a class="header-anchor" href="#_3-3-5-donedata" aria-hidden="true">#</a> 3.3.5 <code>&lt;donedata&gt;</code></h3><p>ä¸€ä¸ªåŒ…è£…å…ƒç´ ï¼Œä¿å­˜è¿›å…¥ <code>&lt;final&gt;</code> çŠ¶æ€æ—¶è¦è¿”å›çš„æ•°æ®ã€‚</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>final</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>æœ€ç»ˆçŠ¶æ€<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>donedata</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param</span> <span class="token attr-name">expr</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&#39;</span>value1&#39;<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>key1<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param</span> <span class="token attr-name">expr</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&#39;</span>value2&#39;<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>key2<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>donedata</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>final</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>children å¯ä»¥åŒ…å«ï¼š</p><ul><li><code>&lt;content&gt;</code>ï¼šå¯ä»¥å‡ºç° 0 æ¬¡æˆ– 1 æ¬¡ã€‚</li><li><code>&lt;param&gt;</code>ï¼šå¯ä»¥å‡ºç° 0 æ¬¡æˆ–å¤šæ¬¡ã€‚</li></ul><p>ä¸€ä¸ªç¬¦åˆæ ‡å‡†çš„ SCXML æ–‡æ¡£å¿…é¡»æŒ‡å®šå•ä¸ª <code>&lt;content&gt;</code> å…ƒç´ æˆ–ä¸€ä¸ªæˆ–å¤šä¸ª <code>&lt;param&gt;</code> å…ƒç´ ä½œä¸º <code>&lt;donedata&gt;</code> çš„å­å…ƒç´ ï¼Œä½†ä¸èƒ½åŒæ—¶æŒ‡å®šä¸¤è€…ã€‚ å¦‚æœ SCXML å¤„ç†å™¨åœ¨è¿›å…¥æœ€ç»ˆçŠ¶æ€æ—¶ç”Ÿæˆâ€œdoneâ€äº‹ä»¶ï¼Œå®ƒå¿…é¡»æ‰§è¡Œ <code>&lt;donedata&gt;</code> å…ƒç´  <code>&lt;param&gt;</code> æˆ– <code>&lt;content&gt;</code> å­å…ƒç´ å¹¶å°†ç»“æœæ•°æ®æ”¾åœ¨ <code>_event.data</code> å­—æ®µä¸­ã€‚</p><p>å¯¹åº”åˆ° XState State Node çš„ <code>data</code> å±æ€§å­—æ®µã€‚</p><p>ç¤ºä¾‹ï¼š</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scxml</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€æœº<span class="token punctuation">&quot;</span></span> <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1.0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2005/07/scxml<span class="token punctuation">&quot;</span></span> <span class="token attr-name">initial</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€A<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>state</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€A<span class="token punctuation">&quot;</span></span> <span class="token attr-name">initial</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€A1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transition</span> <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€B<span class="token punctuation">&quot;</span></span> <span class="token attr-name">event</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>done.state.çŠ¶æ€A<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>log</span> <span class="token attr-name">expr</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>_event.data<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>log</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>transition</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>final</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€A1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>donedata</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param</span> <span class="token attr-name">expr</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>finalCustomeData1<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param</span> <span class="token attr-name">expr</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>finalCustomeData2<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>donedata</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>final</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>state</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>state</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€B<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>state</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scxml</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token function">Machine</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&quot;çŠ¶æ€æœº&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">initial</span><span class="token operator">:</span> <span class="token string">&quot;çŠ¶æ€A&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">context</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">states</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    çŠ¶æ€<span class="token constant">A</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">initial</span><span class="token operator">:</span> <span class="token string">&quot;çŠ¶æ€A1&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">onDone</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">actions</span><span class="token operator">:</span> actions<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">context<span class="token punctuation">,</span> event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> event<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token literal-property property">target</span><span class="token operator">:</span> <span class="token string">&quot;çŠ¶æ€B&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token literal-property property">states</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        çŠ¶æ€<span class="token constant">A1</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;final&quot;</span><span class="token punctuation">,</span>
          <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">finalCustomeData1</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token literal-property property">finalCustomeData2</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    çŠ¶æ€<span class="token constant">B</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="/blog/assets/1662726558121.7dd2e110.webp" alt="" loading="lazy"></p><h3 id="_3-3-6-param" tabindex="-1"><a class="header-anchor" href="#_3-3-6-param" aria-hidden="true">#</a> 3.3.6 <code>&lt;param&gt;</code></h3><p><code>&lt;param&gt;</code> æ ‡ç­¾æä¾›äº†ä¸€ç§è¯†åˆ«é”®å’ŒåŠ¨æ€è®¡ç®—å€¼çš„é€šç”¨æ–¹æ³•ï¼Œè¯¥å€¼å¯ä»¥ä¼ é€’ç»™å¤–éƒ¨æœåŠ¡æˆ–åŒ…å«åœ¨äº‹ä»¶ä¸­ã€‚</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>final</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>æœ€ç»ˆçŠ¶æ€<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>donedata</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param</span> <span class="token attr-name">expr</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&#39;</span>value1&#39;<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>key1<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param</span> <span class="token attr-name">expr</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&#39;</span>value2&#39;<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>key2<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>donedata</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>final</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å±æ€§å­—æ®µæè¿°å¦‚ä¸‹ï¼š</p><table><thead><tr><th>åç§°</th><th>å¿…å¡«</th><th>å±æ€§çº¦æŸ</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>æœ‰æ•ˆå€¼</th><th>æè¿°</th></tr></thead><tbody><tr><td>name</td><td>true</td><td></td><td>NMTOKEN</td><td>none</td><td>å­—ç¬¦ä¸²</td><td></td></tr><tr><td>expr</td><td>false</td><td></td><td>å€¼è¡¨è¾¾å¼</td><td>none</td><td>æœ‰æ•ˆå€¼è¡¨è¾¾å¼</td><td></td></tr><tr><td>location</td><td>false</td><td></td><td>ä½ç½®è¡¨è¾¾å¼</td><td>none</td><td>æœ‰æ•ˆä½ç½®è¡¨è¾¾å¼</td><td></td></tr></tbody></table><p>ç±»ä¼¼äºä¸€ä¸ª key ä¸€ä¸ª value çš„æ–¹å¼å®šä¹‰äº‹ä»¶æ•°æ®ã€‚</p><p>XState æ¯”è¾ƒçµæ´»ï¼Œç›´æ¥åœ¨äº‹ä»¶è¿”å›å¤„å¡«å†™ Object å³å¯ã€‚</p><h3 id="_3-3-7-content" tabindex="-1"><a class="header-anchor" href="#_3-3-7-content" aria-hidden="true">#</a> 3.3.7 <code>&lt;content&gt;</code></h3><p>åŒ…å«è¦ä¼ é€’ç»™å¤–éƒ¨æœåŠ¡çš„æ•°æ®çš„å®¹å™¨å…ƒç´ ã€‚</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>final</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>æœ€ç»ˆçŠ¶æ€<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>donedata</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>content</span><span class="token punctuation">&gt;</span></span>{key1: &#39;value1&#39;, key2: &#39;value2&#39;}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>content</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>donedata</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>final</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å±æ€§å­—æ®µæè¿°å¦‚ä¸‹ï¼š</p><table><thead><tr><th>åç§°</th><th>å¿…å¡«</th><th>å±æ€§çº¦æŸ</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>æœ‰æ•ˆå€¼</th><th>æè¿°</th></tr></thead><tbody><tr><td>expr</td><td>false</td><td>ä¸å¾—ä¸å­å†…å®¹ä¸€èµ·å‡ºç°</td><td>å€¼è¡¨è¾¾å¼</td><td>none</td><td>æœ‰æ•ˆå€¼è¡¨è¾¾å¼</td><td></td></tr></tbody></table><p>å¦‚æœâ€œexprâ€å±æ€§ä¸å­˜åœ¨ï¼Œå¤„ç†å™¨å¿…é¡»ä½¿ç”¨ <code>&lt;content&gt;</code> çš„å­å…ƒç´ ä½œä¸ºè¾“å‡ºã€‚</p><p>ç±»ä¼¼äºä¸€ä¸ª Object çš„æ–¹å¼å®šä¹‰äº‹ä»¶æ•°æ®ã€‚åŠŸèƒ½å’Œ <code>&lt;param&gt;</code> ç›¸ä¼¼ã€‚å¯ä»¥åœ¨ <code>&lt;donedata&gt;</code>ã€<code>&lt;send&gt;</code>ã€<code>&lt;invoke&gt;</code> ä¸­ä½¿ç”¨ã€‚</p><p>XState æ¯”è¾ƒçµæ´»ï¼Œç›´æ¥åœ¨äº‹ä»¶è¿”å›å¤„å¡«å†™ Object å³å¯ã€‚</p><h2 id="_3-4-å¤–éƒ¨é€šè®¯" tabindex="-1"><a class="header-anchor" href="#_3-4-å¤–éƒ¨é€šè®¯" aria-hidden="true">#</a> 3.4 å¤–éƒ¨é€šè®¯</h2><p>å¤–éƒ¨é€šä¿¡åŠŸèƒ½å…è®¸ SCXML ä¼šè¯ä»å¤–éƒ¨å®ä½“å‘é€å’Œæ¥æ”¶äº‹ä»¶ï¼Œå¹¶è°ƒç”¨å¤–éƒ¨æœåŠ¡ã€‚</p><h3 id="_3-4-1-send" tabindex="-1"><a class="header-anchor" href="#_3-4-1-send" aria-hidden="true">#</a> 3.4.1 <code>&lt;send&gt;</code></h3><p><code>&lt;send&gt;</code> ç”¨äºå°†äº‹ä»¶å’Œæ•°æ®å‘é€åˆ°å¤–éƒ¨ç³»ç»Ÿï¼ŒåŒ…æ‹¬å¤–éƒ¨ SCXML è§£é‡Šå™¨ï¼Œæˆ–åœ¨å½“å‰ SCXML ä¼šè¯ä¸­å¼•å‘äº‹ä»¶ã€‚æä¾›â€œå³å‘å³å¼ƒâ€çš„èƒ½åŠ›ã€‚</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scxml</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€æœº<span class="token punctuation">&quot;</span></span> <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1.0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2005/07/scxml<span class="token punctuation">&quot;</span></span> <span class="token attr-name">initial</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€A<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>state</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€A<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>onentry</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>send</span> <span class="token attr-name">event</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>è·³è½¬<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>onentry</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>state</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scxml</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å±æ€§å­—æ®µæè¿°å¦‚ä¸‹ï¼š</p><table><thead><tr><th>åç§°</th><th>å¿…å¡«</th><th>å±æ€§çº¦æŸ</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>æœ‰æ•ˆå€¼</th><th>æè¿°</th></tr></thead><tbody><tr><td>event</td><td>false</td><td>ä¸å¾—ä¸â€œeventexprâ€ä¸€èµ·å‡ºç°</td><td>EventType.datatype</td><td>none</td><td></td><td>ä¸€ä¸ªå­—ç¬¦ä¸²ï¼ŒæŒ‡ç¤ºæ­£åœ¨ç”Ÿæˆçš„æ¶ˆæ¯çš„åç§°</td></tr><tr><td>eventexpr</td><td>false</td><td>ä¸å¾—ä¸â€œeventâ€ä¸€èµ·å‡ºç°</td><td>å€¼è¡¨è¾¾å¼</td><td>none</td><td></td><td>â€œeventâ€çš„åŠ¨æ€æ›¿ä»£æ–¹æ¡ˆã€‚å¦‚æœæ­¤å±æ€§å­˜åœ¨ï¼ŒSCXML å¤„ç†å™¨å¿…é¡»åœ¨æ‰§è¡Œçˆ¶ <code>&lt;send&gt;</code> å…ƒç´ æ—¶å¯¹å…¶è¿›è¡Œæ‰§è¡Œï¼Œå¹¶å°†ç»“æœè§†ä¸ºå·²ä½œä¸ºâ€œeventâ€çš„å€¼è¾“å…¥</td></tr><tr><td>target</td><td>false</td><td>ä¸èƒ½ä¸â€œtargetexprâ€ä¸€èµ·å‡ºç°</td><td>URI</td><td>none</td><td>æœ‰æ•ˆçš„ç›®æ ‡ URI</td><td>å¹³å°åº”å°†äº‹ä»¶å‘é€åˆ°çš„æ¶ˆæ¯ç›®æ ‡çš„å”¯ä¸€æ ‡è¯†ç¬¦</td></tr><tr><td>targetexpr</td><td>false</td><td>ä¸èƒ½ä¸â€œtargetâ€ä¸€èµ·å‡ºç°</td><td>å€¼è¡¨è¾¾å¼</td><td>none</td><td>æœ‰æ•ˆç›®æ ‡ URI çš„è¡¨è¾¾å¼</td><td>â€œtargetâ€çš„åŠ¨æ€æ›¿ä»£æ–¹æ¡ˆã€‚å¦‚æœå­˜åœ¨æ­¤å±æ€§ï¼Œåˆ™ SCXML å¤„ç†å™¨å¿…é¡»åœ¨æ‰§è¡Œçˆ¶ <code>&lt;send&gt;</code> å…ƒç´ æ—¶å¯¹å…¶è¿›è¡Œæ‰§è¡Œï¼Œå¹¶å°†ç»“æœè§†ä¸ºå·²ä½œä¸ºâ€œtargetâ€çš„å€¼è¾“å…¥</td></tr><tr><td>type</td><td>false</td><td>ä¸èƒ½ä¸â€œtypeexprâ€ä¸€èµ·å‡ºç°</td><td>URI</td><td>none</td><td></td><td>æ ‡è¯†æ¶ˆæ¯ä¼ è¾“æœºåˆ¶çš„ URI</td></tr><tr><td>typeexpr</td><td>false</td><td>ä¸èƒ½ä¸â€œtypeâ€ä¸€èµ·å‡ºç°</td><td>å€¼è¡¨è¾¾å¼</td><td>none</td><td></td><td>â€œtypeâ€çš„åŠ¨æ€æ›¿ä»£æ–¹æ¡ˆã€‚å¦‚æœæ­¤å±æ€§å­˜åœ¨ï¼ŒSCXML å¤„ç†å™¨å¿…é¡»åœ¨æ‰§è¡Œçˆ¶ <code>&lt;send&gt;</code> å…ƒç´ æ—¶å¯¹å…¶è¿›è¡Œæ‰§è¡Œï¼Œå¹¶å°†ç»“æœè§†ä¸ºå·²ä½œä¸ºâ€œtypeâ€å€¼è¾“å…¥</td></tr><tr><td>id</td><td>false</td><td>ä¸å¾—ä¸â€œidlocationâ€ä¸€èµ·å‡ºç°</td><td>xml:ID</td><td>none</td><td></td><td>è¦ç”¨ä½œæ­¤ <code>&lt;send&gt;</code> å®ä¾‹çš„æ ‡è¯†ç¬¦çš„å­—ç¬¦ä¸²æ–‡å­—</td></tr><tr><td>idlocation</td><td>false</td><td>ä¸å¾—ä¸â€œidâ€ä¸€èµ·å‡ºç°</td><td>ä½ç½®è¡¨è¾¾å¼</td><td>none</td><td></td><td>ä»»ä½•ä½ç½®è¡¨è¾¾å¼æ‰§è¡Œä¸ºå¯ä»¥å­˜å‚¨ç³»ç»Ÿç”Ÿæˆçš„ id çš„æ•°æ®æ¨¡å‹ä½ç½®</td></tr><tr><td>delay</td><td>false</td><td>ä¸èƒ½ä¸â€œdelayexprâ€æˆ–å±æ€§â€œtargetâ€å…·æœ‰å€¼â€œ_internalâ€ä¸€èµ·å‡ºç°</td><td>Duration.datatype</td><td>none</td><td></td><td>æŒ‡ç¤ºå¤„ç†å™¨åœ¨åˆ†æ´¾æ¶ˆæ¯ä¹‹å‰åº”ç­‰å¾…å¤šé•¿æ—¶é—´</td></tr><tr><td>delayexpr</td><td>false</td><td>ä¸å¾—å‡ºç°åœ¨â€œdelayâ€æˆ–å±æ€§â€œtargetâ€çš„å€¼ä¸ºâ€œ_internalâ€æ—¶</td><td>å€¼è¡¨è¾¾å¼</td><td>none</td><td></td><td>â€œdelayâ€çš„åŠ¨æ€æ›¿ä»£æ–¹æ¡ˆã€‚å¦‚æœæ­¤å±æ€§å­˜åœ¨ï¼ŒSCXML å¤„ç†å™¨å¿…é¡»åœ¨æ‰§è¡Œçˆ¶ <code>&lt;send&gt;</code> å…ƒç´ æ—¶å¯¹å…¶è¿›è¡Œæ‰§è¡Œï¼Œå¹¶å°†ç»“æœè§†ä¸ºå·²ä½œä¸ºâ€œdelayâ€å€¼è¾“å…¥</td></tr><tr><td>namelist</td><td>false</td><td>ä¸å¾—ä¸ <code>&lt;content&gt;</code> å…ƒç´ ä¸€èµ·æŒ‡å®š</td><td>ä½ç½®è¡¨è¾¾å¼åˆ—è¡¨</td><td>none</td><td></td><td>ä¸€ä¸ªæˆ–å¤šä¸ªæ•°æ®æ¨¡å‹ä½ç½®çš„ç©ºæ ¼åˆ†éš”åˆ—è¡¨ï¼Œä½œä¸ºå±æ€§/å€¼å¯¹åŒ…å«åœ¨æ¶ˆæ¯ä¸­ã€‚ ï¼ˆä½ç½®çš„åç§°æ˜¯å±æ€§ï¼Œå­˜å‚¨åœ¨ä½ç½®çš„å€¼æ˜¯å€¼ã€‚ï¼‰</td></tr></tbody></table><p>children å¯ä»¥åŒ…å«ï¼š</p><ul><li><code>&lt;content&gt;</code>ï¼šå¯ä»¥å‡ºç° 0 æ¬¡æˆ– 1 æ¬¡ã€‚</li><li><code>&lt;param&gt;</code>ï¼šå¯ä»¥å‡ºç° 0 æ¬¡æˆ–å¤šæ¬¡ã€‚</li></ul><p>ç¬¦åˆæ ‡å‡†çš„ SCXML æ–‡æ¡£å¿…é¡»å‡†ç¡®æŒ‡å®šâ€œeventâ€ã€â€œeventexprâ€å’Œ <code>&lt;content&gt;</code> ä¹‹ä¸€ã€‚ç¬¦åˆæ ‡å‡†çš„æ–‡æ¡£ä¸å¾—åœ¨ <code>&lt;content&gt;</code> ä¸­æŒ‡å®šâ€œnamelistâ€æˆ– <code>&lt;param&gt;</code>ã€‚</p><ul><li>SCXML å¤„ç†å™¨å¿…é¡»åŒ…å« <code>&lt;param&gt;</code> æˆ– &#39;namelist&#39; æä¾›çš„æ‰€æœ‰å±æ€§å’Œå€¼ï¼Œå³ä½¿å‡ºç°é‡å¤ä¹Ÿæ˜¯å¦‚æ­¤ã€‚</li><li>å¦‚æœå­˜åœ¨â€œidlocationâ€ï¼ŒSCXML å¤„ç†å™¨å¿…é¡»åœ¨æ‰§è¡Œçˆ¶ <code>&lt;send&gt;</code> å…ƒç´ æ—¶ç”Ÿæˆä¸€ä¸ª id å¹¶å°†å…¶å­˜å‚¨åœ¨æ­¤ä½ç½®ã€‚</li><li>å¦‚æœé€šè¿‡â€œdelayâ€æˆ–â€œdelayexprâ€æŒ‡å®šå»¶è¿Ÿï¼ŒSCXML å¤„ç†å™¨å¿…é¡»å°†å­—ç¬¦ä¸²è§£é‡Šä¸ºæ—¶é—´é—´éš”ã€‚ å®ƒå¿…é¡»ä»…åœ¨å»¶è¿Ÿé—´éš”è¿‡å»åæ‰å‘é€æ¶ˆæ¯ã€‚ ï¼ˆè¯·æ³¨æ„ï¼Œå‘é€æ ‡è®°çš„æ‰§è¡Œå°†ç«‹å³è¿”å›ã€‚ï¼‰å¤„ç†å™¨å¿…é¡»åœ¨æ‰§è¡Œ <code>&lt;send&gt;</code> å…ƒç´ æ—¶æ‰§è¡Œæ‰€æœ‰å‚æ•°åˆ° <code>&lt;send&gt;</code>ï¼Œè€Œä¸æ˜¯åœ¨å®é™…å‘é€æ¶ˆæ¯æ—¶æ‰§è¡Œã€‚ å¦‚æœ <code>&lt;send&gt;</code> å‚æ•°çš„æ‰§è¡Œäº§ç”Ÿé”™è¯¯ï¼Œå¤„ç†å™¨å¿…é¡»ä¸¢å¼ƒè¯¥æ¶ˆæ¯è€Œä¸å°è¯•ä¼ é€’å®ƒã€‚ å¦‚æœ SCXML ä¼šè¯åœ¨å»¶è¿Ÿé—´éš”è¿‡å»ä¹‹å‰ç»ˆæ­¢ï¼Œåˆ™ SCXML å¤„ç†å™¨å¿…é¡»ä¸¢å¼ƒè¯¥æ¶ˆæ¯è€Œä¸å°è¯•ä¼ é€’å®ƒã€‚</li></ul><p>å¯¹åº” XState çš„ <code>actions.send</code> å‡½æ•°ã€‚ç»“æ„ç±»ä¼¼ï¼š</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token string">&quot;scxml.event&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;options&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;scxml.id&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;delay&quot;</span><span class="token operator">:</span> <span class="token string">&quot;scxml.delay&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;to&quot;</span><span class="token operator">:</span> <span class="token string">&quot;scxml.target&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç¤ºä¾‹ï¼š</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scxml</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€æœº<span class="token punctuation">&quot;</span></span> <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1.0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2005/07/scxml<span class="token punctuation">&quot;</span></span> <span class="token attr-name">initial</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€A<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>state</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€A<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transition</span> <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€B<span class="token punctuation">&quot;</span></span> <span class="token attr-name">event</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>è·³è½¬<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>transition</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>onentry</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>send</span> <span class="token attr-name">event</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>è·³è½¬<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>onentry</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>state</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>state</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€B<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>state</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scxml</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token function">Machine</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&quot;çŠ¶æ€æœº&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">initial</span><span class="token operator">:</span> <span class="token string">&quot;çŠ¶æ€A&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">states</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    çŠ¶æ€<span class="token constant">A</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">onEntry</span><span class="token operator">:</span> actions<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">&quot;è·³è½¬&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token literal-property property">on</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">è·³è½¬</span><span class="token operator">:</span> <span class="token string">&quot;çŠ¶æ€B&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    çŠ¶æ€<span class="token constant">B</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="/blog/assets/1662726585203.98fad3f3.webp" alt="" loading="lazy"></p><h3 id="_3-4-2-cancel" tabindex="-1"><a class="header-anchor" href="#_3-4-2-cancel" aria-hidden="true">#</a> 3.4.2 <code>&lt;cancel&gt;</code></h3><p><code>&lt;cancel&gt;</code> å…ƒç´ ç”¨äºå–æ¶ˆå»¶è¿Ÿçš„ <code>&lt;send&gt;</code> äº‹ä»¶ã€‚ SCXML å¤„ç†å™¨ä¸å¾—å…è®¸ <code>&lt;cancel&gt;</code> å½±å“æœªåœ¨åŒä¸€ä¼šè¯ä¸­å¼•å‘çš„äº‹ä»¶ã€‚ å¤„ç†å™¨åº”å°½æœ€å¤§åŠªåŠ›å–æ¶ˆå…·æœ‰æŒ‡å®š ID çš„æ‰€æœ‰å»¶è¿Ÿäº‹ä»¶ã€‚ ä½†æ˜¯è¯·æ³¨æ„ï¼Œå®ƒä¸èƒ½ä¿è¯æˆåŠŸï¼Œä¾‹å¦‚ï¼Œå¦‚æœäº‹ä»¶åœ¨ <code>&lt;cancel&gt;</code> æ ‡è®°æ‰§è¡Œæ—¶å·²ç»äº¤ä»˜ã€‚</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scxml</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€æœº<span class="token punctuation">&quot;</span></span> <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1.0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2005/07/scxml<span class="token punctuation">&quot;</span></span> <span class="token attr-name">initial</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€A<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>state</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€A<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>onentry</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cancel</span> <span class="token attr-name">sendid</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>è·³è½¬ID<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>onentry</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>state</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scxml</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å±æ€§å­—æ®µæè¿°å¦‚ä¸‹ï¼š</p><table><thead><tr><th>åç§°</th><th>å¿…å¡«</th><th>å±æ€§çº¦æŸ</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>æœ‰æ•ˆå€¼</th><th>æè¿°</th></tr></thead><tbody><tr><td>sendid</td><td>false</td><td>ä¸å¾—ä¸ sendideexpr ä¸€èµ·å‡ºç°</td><td>IDREF</td><td>none</td><td>å»¶è¿Ÿäº‹ä»¶çš„ sendid</td><td>è¦å–æ¶ˆçš„äº‹ä»¶çš„ IDã€‚å¦‚æœå¤šä¸ªå»¶è¿Ÿäº‹ä»¶æœ‰è¿™ä¸ª sendidï¼Œå¤„ç†å™¨å°†å…¨éƒ¨å–æ¶ˆ</td></tr><tr><td>sendidexpr</td><td>false</td><td>ä¸å¾—ä¸ sendid ä¸€èµ·å‡ºç°</td><td>å€¼è¡¨è¾¾å¼</td><td>none</td><td>è®¡ç®—ç»“æœä¸ºå»¶è¿Ÿäº‹ä»¶ ID çš„ä»»ä½•è¡¨è¾¾å¼</td><td>&#39;sendid&#39; çš„åŠ¨æ€æ›¿ä»£æ–¹æ¡ˆã€‚å¦‚æœæ­¤å±æ€§å­˜åœ¨ï¼ŒSCXML å¤„ç†å™¨å¿…é¡»åœ¨æ‰§è¡Œçˆ¶ <code>&lt;cancel&gt;</code> å…ƒç´ æ—¶å¯¹å…¶è¿›è¡Œæ‰§è¡Œï¼Œå¹¶å°†ç»“æœè§†ä¸ºå·²ä½œä¸ºâ€œsendidâ€çš„å€¼è¾“å…¥</td></tr></tbody></table><p>å¯¹åº” XState çš„ <code>actions.cancel</code> å‡½æ•°ã€‚</p><p>ç¤ºä¾‹ï¼š</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scxml</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€æœº<span class="token punctuation">&quot;</span></span> <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1.0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2005/07/scxml<span class="token punctuation">&quot;</span></span> <span class="token attr-name">initial</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>æœªç™»å½•<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>state</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>æœªç™»å½•<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transition</span> <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>å·²ç™»å½•<span class="token punctuation">&quot;</span></span> <span class="token attr-name">event</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ç™»å½•<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>transition</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>state</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>state</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>å·²ç™»å½•<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transition</span> <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>å·²ç™»å½•<span class="token punctuation">&quot;</span></span> <span class="token attr-name">event</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>æ´»åŠ¨<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>transition</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>onentry</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>send</span> <span class="token attr-name">event</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>æ³¨é”€<span class="token punctuation">&quot;</span></span> <span class="token attr-name">delay</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1000 * 60<span class="token punctuation">&quot;</span></span> <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>æœªç™»å½•<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>æ¶ˆæ¯ID<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>onentry</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>onexit</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cancel</span> <span class="token attr-name">sendid</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>æ¶ˆæ¯ID<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>cancel</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>onexit</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>state</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scxml</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token function">Machine</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&quot;çŠ¶æ€æœº&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">initial</span><span class="token operator">:</span> <span class="token string">&quot;æœªç™»å½•&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">states</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">æœªç™»å½•</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">on</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">ç™»å½•</span><span class="token operator">:</span> <span class="token string">&quot;å·²ç™»å½•&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">å·²ç™»å½•</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">onEntry</span><span class="token operator">:</span> actions<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">&quot;æ³¨é”€&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">delay</span><span class="token operator">:</span> <span class="token number">1000</span> <span class="token operator">*</span> <span class="token number">60</span><span class="token punctuation">,</span>
        <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&quot;æ¶ˆæ¯ID&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token literal-property property">onExit</span><span class="token operator">:</span> actions<span class="token punctuation">.</span><span class="token function">cancel</span><span class="token punctuation">(</span><span class="token string">&quot;æ¶ˆæ¯ID&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token literal-property property">on</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">æ³¨é”€</span><span class="token operator">:</span> <span class="token string">&quot;æœªç™»å½•&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">æ´»åŠ¨</span><span class="token operator">:</span> <span class="token string">&quot;å·²ç™»å½•&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="/blog/assets/1662726608095.ac5d75cb.webp" alt="" loading="lazy"></p><p>ä¹Ÿå¯ä»¥ä½¿ç”¨ XState çš„ <code>after</code> è¯­æ³•ç³–æ¥å®ç°ï¼š</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token function">Machine</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&quot;çŠ¶æ€æœº&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">initial</span><span class="token operator">:</span> <span class="token string">&quot;æœªç™»å½•&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">states</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">æœªç™»å½•</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">on</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">ç™»å½•</span><span class="token operator">:</span> <span class="token string">&quot;å·²ç™»å½•&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">å·²ç™»å½•</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">after</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token punctuation">[</span><span class="token number">1000</span> <span class="token operator">*</span> <span class="token number">60</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token string">&quot;æœªç™»å½•&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token literal-property property">on</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">æ´»åŠ¨</span><span class="token operator">:</span> <span class="token string">&quot;å·²ç™»å½•&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="/blog/assets/1662726632943.0954bdb3.webp" alt="" loading="lazy"></p><h3 id="_3-4-3-invoke" tabindex="-1"><a class="header-anchor" href="#_3-4-3-invoke" aria-hidden="true">#</a> 3.4.3 <code>&lt;invoke&gt;</code></h3><p><code>&lt;invoke&gt;</code> å…ƒç´ ç”¨äºåˆ›å»ºå¤–éƒ¨æœåŠ¡çš„å®ä¾‹ã€‚</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>invoke</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ID_SUB<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sub.scxml<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param</span> <span class="token attr-name">expr</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>3<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>i_ID<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>invoke</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>&lt;invoke&gt;</code> æä¾›äº†ä¸€ç§æ›´ç´§å¯†è€¦åˆçš„é€šä¿¡å½¢å¼ï¼Œç‰¹åˆ«æ˜¯èƒ½å¤Ÿè§¦å‘å¹³å°å®šä¹‰çš„æœåŠ¡å¹¶å°†æ•°æ®ä¼ é€’ç»™å®ƒã€‚ å®ƒåŠå…¶å­ <code>&lt;finalize&gt;</code> åœ¨æ¨¡æ‹Ÿå¤–éƒ¨æœåŠ¡è¡Œä¸ºçš„çŠ¶æ€ä¸­å¾ˆæœ‰ç”¨ã€‚ <code>&lt;invoke&gt;</code> å…ƒç´ åœ¨çŠ¶æ€çš„ <code>&lt;onentry&gt;</code> å…ƒç´ ä¹‹åæ‰§è¡Œï¼Œå¹¶å¯¼è‡´åˆ›å»ºå¤–éƒ¨æœåŠ¡çš„å®ä¾‹ã€‚ <code>&lt;param&gt;</code> å’Œ <code>&lt;content&gt;</code> å…ƒç´ ä»¥åŠ &#39;namelist&#39; å±æ€§å¯ç”¨äºå°†æ•°æ®ä¼ é€’ç»™æœåŠ¡ã€‚ å½“å¹¶è¡ŒçŠ¶æ€åŒæ—¶è°ƒç”¨ç›¸åŒçš„å¤–éƒ¨æœåŠ¡æ—¶ï¼Œå°†å¯åŠ¨å¤–éƒ¨æœåŠ¡çš„å•ç‹¬å®ä¾‹ã€‚ å®ƒä»¬å¯ä»¥é€šè¿‡ä¸å®ƒä»¬ç›¸å…³è”çš„ id æ¥åŒºåˆ†ã€‚ ç±»ä¼¼åœ°ï¼Œä»å¤–éƒ¨æœåŠ¡è¿”å›çš„äº‹ä»¶ä¸­åŒ…å«çš„ id å¯ç”¨äºç¡®å®šå“ªäº›äº‹ä»¶æ˜¯å¯¹å“ªäº›è°ƒç”¨çš„å“åº”ã€‚ è¿”å›çš„æ¯ä¸ªäº‹ä»¶å°†ä»…ç”±è°ƒç”¨å®ƒçš„çŠ¶æ€ä¸­çš„ <code>&lt;finalize&gt;</code> å¤„ç†ï¼Œä½†è¯¥äº‹ä»¶éšåä¼šåƒçŠ¶æ€æœºæ¥æ”¶çš„ä»»ä½•å…¶ä»–äº‹ä»¶ä¸€æ ·è¢«å¤„ç†ã€‚ å› æ­¤ï¼Œfinalize ä»£ç å¯ä»¥è¢«è®¤ä¸ºæ˜¯åœ¨å°†äº‹ä»¶æ·»åŠ åˆ°äº‹ä»¶é˜Ÿåˆ—ä¹‹å‰åº”ç”¨çš„é¢„å¤„ç†é˜¶æ®µã€‚ è¯·æ³¨æ„ï¼Œè¯¥äº‹ä»¶å°†ä¼ é€’ç»™æ‰€æœ‰å¹¶è¡ŒçŠ¶æ€ä»¥æ£€æŸ¥è½¬æ¢ã€‚ ç”±äºå½“çŠ¶æ€æœºç¦»å¼€è°ƒç”¨çŠ¶æ€æ—¶è°ƒç”¨å°†è¢«å–æ¶ˆï¼Œå› æ­¤åœ¨å°†ç«‹å³é€€å‡ºçš„çŠ¶æ€ä¸‹å¼€å§‹è°ƒç”¨æ˜¯æ²¡æœ‰æ„ä¹‰çš„ã€‚ å› æ­¤ï¼Œ<code>&lt;invoke&gt;</code> å…ƒç´ åœ¨è¿›å…¥çŠ¶æ€æ—¶æ‰§è¡Œï¼Œä½†ä»…åœ¨æ£€æŸ¥æ— äº‹ä»¶è½¬æ¢å’Œæœªå†³å†…éƒ¨äº‹ä»¶é©±åŠ¨çš„è½¬æ¢ä¹‹åã€‚ å¦‚æœæ‰¾åˆ°ä»»ä½•æ­¤ç±»å¯ç”¨çš„è½¬æ¢ï¼Œåˆ™ç«‹å³æ‰§è¡Œè¯¥è½¬æ¢å¹¶ç«‹å³é€€å‡ºè¯¥çŠ¶æ€ï¼Œè€Œä¸ä¼šè§¦å‘è°ƒç”¨ã€‚ å› æ­¤ï¼Œåªæœ‰åœ¨çŠ¶æ€æœºè¾¾åˆ°ç¨³å®šé…ç½®æ—¶æ‰ä¼šè§¦å‘è°ƒç”¨ï¼Œå³åœ¨ç­‰å¾…å¤–éƒ¨äº‹ä»¶æ—¶å®ƒå°†åœç•™åœ¨å…¶ä¸­çš„é…ç½®ã€‚</p><p>å±æ€§å­—æ®µæè¿°å¦‚ä¸‹ï¼š</p><table><thead><tr><th>åç§°</th><th>å¿…å¡«</th><th>å±æ€§çº¦æŸ</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>æœ‰æ•ˆå€¼</th><th>æè¿°</th></tr></thead><tbody><tr><td>type</td><td>false</td><td>ä¸èƒ½ä¸â€œtypeexprâ€å±æ€§ä¸€èµ·å‡ºç°</td><td>URI</td><td>none</td><td></td><td>æŒ‡å®šå¤–éƒ¨æœåŠ¡ç±»å‹çš„ URI</td></tr><tr><td>typeexpr</td><td>false</td><td>ä¸å¾—ä¸â€œtypeâ€å±æ€§ä¸€èµ·å‡ºç°</td><td>å€¼è¡¨è¾¾å¼</td><td>none</td><td>è®¡ç®—ç»“æœä¸º URI çš„ä»»ä½•å€¼è¡¨è¾¾å¼ï¼Œè¯¥ URI å°†æ˜¯ &#39;type&#39; çš„æœ‰æ•ˆå€¼</td><td>â€œtypeâ€çš„åŠ¨æ€æ›¿ä»£æ–¹æ¡ˆã€‚å¦‚æœæ­¤å±æ€§å­˜åœ¨ï¼ŒSCXML å¤„ç†å™¨å¿…é¡»åœ¨æ‰§è¡Œçˆ¶ <code>&lt;invoke&gt;</code> å…ƒç´ æ—¶å¯¹å…¶è¿›è¡Œæ‰§è¡Œï¼Œå¹¶å°†ç»“æœè§†ä¸ºå·²ä½œä¸ºâ€œtypeâ€çš„å€¼è¾“å…¥</td></tr><tr><td>src</td><td>false</td><td></td><td>URI</td><td>none</td><td></td><td>è¦ä¼ é€’ç»™å¤–éƒ¨æœåŠ¡çš„ URI</td></tr><tr><td>srcexpr</td><td>false</td><td></td><td>å€¼è¡¨è¾¾å¼</td><td>none</td><td></td><td>&#39;src&#39; çš„åŠ¨æ€æ›¿ä»£æ–¹æ¡ˆã€‚å¦‚æœæ­¤å±æ€§å­˜åœ¨ï¼ŒSCXML å¤„ç†å™¨å¿…é¡»åœ¨æ‰§è¡Œçˆ¶ <code>&lt;invoke&gt;</code> å…ƒç´ æ—¶å¯¹å…¶è¿›è¡Œæ‰§è¡Œï¼Œå¹¶å°†ç»“æœè§†ä¸ºå·²ä½œä¸ºâ€œsrcâ€çš„å€¼è¾“å…¥</td></tr><tr><td>id</td><td>false</td><td></td><td>ID</td><td>none</td><td></td><td>è¦ç”¨ä½œæ­¤ <code>&lt;invoke&gt;</code> å®ä¾‹çš„æ ‡è¯†ç¬¦çš„å­—ç¬¦ä¸²æ–‡å­—</td></tr><tr><td>idlocation</td><td>false</td><td></td><td>ä½ç½®è¡¨è¾¾å¼</td><td>none</td><td></td><td>ä»»ä½•å¯¹æ•°æ®æ¨¡å‹ä½ç½®æ±‚å€¼çš„æ•°æ®æ¨¡å‹è¡¨è¾¾å¼</td></tr><tr><td>namelist</td><td>false</td><td></td><td>ä½ç½®è¡¨è¾¾å¼åˆ—è¡¨</td><td>none</td><td></td><td>è¦ä½œä¸ºå±æ€§/å€¼å¯¹ä¼ é€’ç»™è°ƒç”¨æœåŠ¡çš„ä¸€ä¸ªæˆ–å¤šä¸ªæ•°æ®æ¨¡å‹ä½ç½®çš„ç©ºæ ¼åˆ†éš”åˆ—è¡¨ã€‚ ï¼ˆä½ç½®çš„åç§°æ˜¯å±æ€§ï¼Œä½ç½®å­˜å‚¨çš„å€¼æ˜¯å€¼ã€‚ï¼‰</td></tr><tr><td>autoforward</td><td>false</td><td></td><td>å¸ƒå°”å€¼</td><td>false</td><td></td><td>æŒ‡ç¤ºæ˜¯å¦å°†äº‹ä»¶è½¬å‘åˆ°è°ƒç”¨çš„è¿›ç¨‹çš„æ ‡å¿—</td></tr></tbody></table><p>children å¯ä»¥åŒ…å«ï¼š</p><ul><li><code>&lt;content&gt;</code>ï¼šå¯ä»¥å‡ºç° 0 æ¬¡æˆ– 1 æ¬¡ã€‚</li><li><code>&lt;param&gt;</code>ï¼šå¯ä»¥å‡ºç° 0 æ¬¡æˆ–å¤šæ¬¡ã€‚</li><li><code>&lt;finalize&gt;</code>ï¼šå¯ä»¥å‡ºç° 0 æ¬¡æˆ– 1 æ¬¡ã€‚</li></ul><p>å½“ <code>autoforward</code> å±æ€§è®¾ç½®ä¸º true æ—¶ï¼ŒSCXML å¤„ç†å™¨å¿…é¡»å°†å®ƒæ¥æ”¶åˆ°çš„æ¯ä¸ªå¤–éƒ¨äº‹ä»¶çš„ç²¾ç¡®å‰¯æœ¬å‘é€åˆ°è°ƒç”¨çš„è¿›ç¨‹ã€‚SCXML å¤„ç†å™¨å¿…é¡»åœ¨å°†äº‹ä»¶ä»è°ƒç”¨ä¼šè¯çš„å¤–éƒ¨äº‹ä»¶é˜Ÿåˆ—ä¸­åˆ é™¤ä»¥è¿›è¡Œå¤„ç†æ—¶è½¬å‘è¯¥äº‹ä»¶ã€‚</p><p>å¤–éƒ¨æœåŠ¡åœ¨å¤„ç†æ—¶å¯èƒ½ä¼šè¿”å›å¤šä¸ªäº‹ä»¶ã€‚å¦‚æœ <code>&lt;invoke&gt;</code> å®ä¾‹ä¸­æœ‰ä¸€ä¸ª <code>&lt;finalize&gt;</code> å¤„ç†ç¨‹åºåˆ›å»ºäº†ç”Ÿæˆäº‹ä»¶çš„æœåŠ¡ï¼Œåˆ™ SCXML å¤„ç†å™¨å¿…é¡»åœ¨ä»äº‹ä»¶é˜Ÿåˆ—ä¸­åˆ é™¤äº‹ä»¶ä»¥è¿›è¡Œå¤„ç†ä¹‹å‰ç«‹å³æ‰§è¡Œè¯¥ <code>&lt;finalize&gt;</code> å¤„ç†ç¨‹åºä¸­çš„ä»£ç ã€‚å®ƒç»ä¸èƒ½åœ¨ <code>&lt;invoke&gt;</code> çš„ä»»ä½•å…¶ä»–å®ä¾‹ä¸­æ‰§è¡Œ <code>&lt;finalize&gt;</code> å¤„ç†ç¨‹åºã€‚ä¸€æ—¦å¤–éƒ¨æœåŠ¡å®Œæˆå¤„ç†ï¼Œå®ƒå¿…é¡»è¿”å›ä¸€ä¸ªç‰¹æ®Šäº‹ä»¶ <code>done.invoke.id</code> åˆ°è°ƒç”¨è¿›ç¨‹çš„å¤–éƒ¨äº‹ä»¶é˜Ÿåˆ—ï¼Œå…¶ä¸­ id æ˜¯å¯¹åº” <code>&lt;invoke&gt;</code> å…ƒç´ çš„è°ƒç”¨ IDã€‚å¤–éƒ¨æœåŠ¡ä¸å¾— åœ¨æ­¤å®Œæˆäº‹ä»¶ä¹‹åç”Ÿæˆä»»ä½•å…¶ä»–äº‹ä»¶ã€‚</p><h4 id="invoke-çš„å®ç°" tabindex="-1"><a class="header-anchor" href="#invoke-çš„å®ç°" aria-hidden="true">#</a> <code>&lt;invoke&gt;</code> çš„å®ç°</h4><p>åŒ…æ‹¬çˆ¶è¿›ç¨‹å’Œå­è¿›ç¨‹ä¹‹é—´çš„é€šä¿¡ï¼Œæ˜¯ç‰¹å®šäºå¹³å°çš„ï¼Œä½†æ˜¯åœ¨è¢«è°ƒç”¨çš„è¿›ç¨‹æœ¬èº«æ˜¯ SCXML ä¼šè¯çš„æƒ…å†µä¸‹ï¼Œä»¥ä¸‹è¦æ±‚æˆç«‹ï¼š</p><ul><li>å¦‚æœ <code>&lt;invoke&gt;</code> ä¸­çš„ <code>&lt;param&gt;</code> å…ƒç´ çš„ <code>name</code> ä¸è°ƒç”¨ä¼šè¯çš„é¡¶çº§æ•°æ®å£°æ˜ä¸­çš„ <code>&lt;data&gt;</code> å…ƒç´ çš„ <code>id</code> åŒ¹é…ï¼Œåˆ™ SCXML å¤„ç†å™¨å¿…é¡»ä½¿ç”¨ <code>&lt;param &gt;</code> å…ƒç´ ä½œä¸ºç›¸åº” <code>&lt;data&gt;</code> å…ƒç´ çš„åˆå§‹å€¼ã€‚ï¼ˆé¡¶çº§æ•°æ®å£°æ˜æ˜¯åŒ…å«åœ¨ <code>&lt;scxml&gt;</code> å­å…ƒç´ çš„ <code>&lt;datamodel&gt;</code> å…ƒç´ ä¸­çš„é‚£äº›å£°æ˜ã€‚ï¼‰ï¼ˆè¯·æ³¨æ„ï¼Œè¿™æ„å‘³ç€åœ¨ <code>&lt;data&gt;</code> å…ƒç´ ä¸­æŒ‡å®šçš„ä»»ä½•å€¼éƒ½å°†è¢«å¿½ç•¥ã€‚ï¼‰ <code>namelist</code> ç±»ä¼¼ã€‚å¦‚æœåç§°åˆ—è¡¨ä¸­é”®çš„å€¼ä¸è°ƒç”¨ä¼šè¯çš„é¡¶çº§æ•°æ®æ¨¡å‹ä¸­çš„ <code>&lt;data&gt;</code> å…ƒç´ çš„ <code>id</code> åŒ¹é…ï¼Œ scxml å¤„ç†å™¨å¿…é¡»ä½¿ç”¨é”®çš„å€¼ä½œä¸ºç›¸åº” <code>&lt;data&gt;</code> å…ƒç´ çš„åˆå§‹å€¼ã€‚å¦‚æœåç§°ä¸åŒ¹é…ï¼Œå¤„ç†å™¨ä¸å¾— å°† <code>&lt;param&gt;</code> å…ƒç´ æˆ–åç§°åˆ—è¡¨é”®/å€¼å¯¹çš„å€¼æ·»åŠ åˆ°è°ƒç”¨ä¼šè¯çš„æ•°æ®æ¨¡å‹ä¸­ã€‚ä½†æ˜¯ï¼Œå¤„ç†å™¨å¯ä»¥é€šè¿‡å…¶ä»–ä¸€äº›ç‰¹å®šäºå¹³å°çš„æ–¹å¼ä½¿è¿™äº›å€¼å¯ç”¨ã€‚</li><li>å½“è¢«è°ƒç”¨çš„çŠ¶æ€æœºè¾¾åˆ°é¡¶çº§æœ€ç»ˆçŠ¶æ€æ—¶ï¼Œå¤„ç†å™¨å¿…é¡»æ”¾ç½®äº‹ä»¶ <code>done.invoke.id</code> ä¸Šè°ƒç”¨æœºï¼Œå…¶ä¸­æ‰€è¿°å¤–éƒ¨äº‹ä»¶é˜Ÿåˆ— ID æ˜¯ç”¨äºæ­¤è°ƒç”¨çš„è°ƒç”¨ IDã€‚è¯·æ³¨æ„ï¼Œè¾¾åˆ°é¡¶çº§æœ€ç»ˆçŠ¶æ€å¯¹åº”äºæœºå™¨çš„æ­£å¸¸ç»ˆæ­¢ï¼Œå¹¶ä¸”ä¸€æ—¦å¤„äºæ­¤çŠ¶æ€ï¼Œå®ƒå°±æ— æ³•ç”Ÿæˆæˆ–å¤„ç†ä»»ä½•è¿›ä¸€æ­¥çš„äº‹ä»¶ã€‚</li><li>å¦‚ä¸Šæ‰€è¿°ï¼Œå¦‚æœè°ƒç”¨çŠ¶æ€æœºåœ¨æ¥æ”¶åˆ° <code>done.invoke</code> ä¹‹å‰é€€å‡ºåŒ…å«è°ƒç”¨çš„çŠ¶æ€ã€‚id äº‹ä»¶ï¼Œå®ƒå–æ¶ˆè°ƒç”¨çš„ä¼šè¯ã€‚æ‰§è¡Œæ­¤æ“ä½œçš„æ–¹æ³•æ˜¯ç‰¹å®šäºå¹³å°çš„ã€‚ç„¶è€Œï¼Œå½“å®ƒè¢«å–æ¶ˆæ—¶ï¼Œè¢«è°ƒç”¨çš„ä¼šè¯å¿…é¡»åœ¨ä¸‹ä¸€ä¸ªå¾®æ­¥ç»“æŸæ—¶é€€å‡ºã€‚å¤„ç†å™¨å¿…é¡»ä¸ºè¢«è°ƒç”¨ä¼šè¯ä¸­çš„æ‰€æœ‰æ´»åŠ¨çŠ¶æ€æ‰§è¡Œ <code>&lt;onexit&gt;</code> å¤„ç†ç¨‹åºï¼Œä½†å®ƒä¸èƒ½ ç”Ÿæˆ <code>done.invoke.id</code> äº‹ä»¶ã€‚ä¸€æ—¦å–æ¶ˆè°ƒç”¨çš„ä¼šè¯ï¼Œå¤„ç†å™¨å¿…é¡»å¿½ç•¥å®ƒä»è¯¥ä¼šè¯æ¥æ”¶åˆ°çš„ä»»ä½•äº‹ä»¶ã€‚ç‰¹åˆ«æ˜¯å®ƒç»ä¸èƒ½å°†å®ƒä»¬æ’å…¥åˆ°è°ƒç”¨ä¼šè¯çš„å¤–éƒ¨äº‹ä»¶é˜Ÿåˆ—ä¸­ã€‚</li><li>SCXML å¤„ç†å™¨å¿…é¡»æ”¯æŒä½¿ç”¨ SCXML äº‹ä»¶ I/O å¤„ç†å™¨åœ¨è°ƒç”¨ä¼šè¯å’Œè¢«è°ƒç”¨ä¼šè¯ä¹‹é—´è¿›è¡Œé€šä¿¡ã€‚å¤„ç†å™¨å¯ä»¥æ”¯æŒä½¿ç”¨å…¶ä»–äº‹ä»¶ I/O å¤„ç†å™¨åœ¨è°ƒç”¨ä¼šè¯å’Œè¢«è°ƒç”¨ä¼šè¯ä¹‹é—´è¿›è¡Œé€šä¿¡ã€‚</li></ul><p>å¯¹åº” XState State Node çš„ <code>invoke</code> å±æ€§ã€‚æè¿°å¦‚ä¸‹ï¼š</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;src&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;autoForward&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;onDone&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;onError&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç¤ºä¾‹ï¼š</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scxml</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€æœº<span class="token punctuation">&quot;</span></span> <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1.0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2005/07/scxml<span class="token punctuation">&quot;</span></span> <span class="token attr-name">initial</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ç­‰å¾…ä¸­<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>state</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ç­‰å¾…ä¸­<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transition</span> <span class="token attr-name">event</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>done.invoke.å­çŠ¶æ€æœº<span class="token punctuation">&quot;</span></span> <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>æ—¶é—´åˆ°<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>invoke</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>å­çŠ¶æ€æœº<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/TR/scxml/<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>content</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scxml</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>åˆ†é’Ÿå­çŠ¶æ€æœº<span class="token punctuation">&quot;</span></span> <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1.0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2005/07/scxml<span class="token punctuation">&quot;</span></span> <span class="token attr-name">initial</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ç­‰å¾…ä¸­<span class="token punctuation">&quot;</span></span> <span class="token attr-name">initial</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>æ¿€æ´»ä¸­<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>state</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>æ¿€æ´»ä¸­<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>onentry</span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>send</span> <span class="token attr-name">delay</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>60s<span class="token punctuation">&quot;</span></span> <span class="token attr-name">event</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ç»“æŸ<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>send</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>onentry</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transition</span> <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>å®Œæˆ<span class="token punctuation">&quot;</span></span> <span class="token attr-name">event</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ç»“æŸ<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>transition</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>state</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>final</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>å®Œæˆ<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>final</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scxml</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>content</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>invoke</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>state</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>final</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>æ—¶é—´åˆ°<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>final</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scxml</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> minuteMachine <span class="token operator">=</span> <span class="token function">Machine</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&quot;åˆ†é’Ÿå­çŠ¶æ€æœº&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">initial</span><span class="token operator">:</span> <span class="token string">&quot;æ¿€æ´»ä¸­&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">states</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">æ¿€æ´»ä¸­</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">after</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token number">60000</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">target</span><span class="token operator">:</span> <span class="token string">&quot;å®Œæˆ&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">å®Œæˆ</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;final&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">Machine</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&quot;çŠ¶æ€æœº&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">initial</span><span class="token operator">:</span> <span class="token string">&quot;ç­‰å¾…ä¸­&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">states</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">ç­‰å¾…ä¸­</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">invoke</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">src</span><span class="token operator">:</span> minuteMachine<span class="token punctuation">,</span>
        <span class="token literal-property property">onDone</span><span class="token operator">:</span> <span class="token string">&quot;æ—¶é—´åˆ°&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">æ—¶é—´åˆ°</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;final&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="/blog/assets/1662726657393.adcc3183.webp" alt="" loading="lazy"></p><h3 id="_3-4-4-finalize" tabindex="-1"><a class="header-anchor" href="#_3-4-4-finalize" aria-hidden="true">#</a> 3.4.4 <code>&lt;finalize&gt;</code></h3><p><code>&lt;finalize&gt;</code> å…ƒç´ ä½¿è°ƒç”¨ä¼šè¯èƒ½å¤Ÿä½¿ç”¨è¢«è°ƒç”¨ä¼šè¯è¿”å›çš„äº‹ä»¶ä¸­åŒ…å«çš„æ•°æ®æ›´æ–°å…¶æ•°æ®æ¨¡å‹ã€‚</p><p><code>&lt;finalize&gt;</code> åŒ…å«åœ¨æ‰§è¡Œ <code>&lt;invoke&gt;</code> åå¤–éƒ¨æœåŠ¡è¿”å›äº‹ä»¶æ—¶æ‰§è¡Œçš„å¯æ‰§è¡Œå†…å®¹ã€‚ åœ¨ç³»ç»ŸæŸ¥æ‰¾ä¸äº‹ä»¶åŒ¹é…çš„è½¬æ¢ä¹‹å‰åº”ç”¨æ­¤å†…å®¹ã€‚ åœ¨å¯æ‰§è¡Œå†…å®¹ä¸­ï¼Œç³»ç»Ÿå˜é‡â€œ_eventâ€å¯ç”¨äºå¼•ç”¨æ­£åœ¨å¤„ç†çš„äº‹ä»¶ä¸­åŒ…å«çš„æ•°æ®ã€‚åœ¨å¹¶è¡ŒçŠ¶æ€çš„æƒ…å†µä¸‹ï¼Œä»…æ‰§è¡ŒåŸå§‹è°ƒç”¨çŠ¶æ€ä¸‹çš„ finalize ä»£ç ã€‚ åœ¨è°ƒç”¨æœŸé—´çŠ¶æ€æœºä»è¢«è°ƒç”¨ç»„ä»¶æ¥æ”¶åˆ°çš„ä»»ä½•äº‹ä»¶éƒ½ç”± <code>&lt;finalize&gt;</code> å¤„ç†ç¨‹åºåœ¨é€‰æ‹©è½¬æ¢ä¹‹å‰è¿›è¡Œé¢„å¤„ç†ã€‚ finalize&gt; ä»£ç ç”¨äºè§„èŒƒåŒ–è¿”å›æ•°æ®çš„å½¢å¼ï¼Œå¹¶åœ¨æ‰§è¡Œè½¬æ¢çš„â€œeventâ€å’Œâ€œcondâ€å­å¥ä¹‹å‰æ›´æ–°æ•°æ®æ¨¡å‹ã€‚ åœ¨ç¬¦åˆçš„ SCXML æ–‡ä»¶ï¼Œåœ¨&lt;æ•²å®š&gt;çš„å¯æ‰§è¡Œå†…å®¹ä¸å¾—å¼•å‘äº‹ä»¶æˆ–è°ƒç”¨å¤–éƒ¨åŠ¨ä½œã€‚ç‰¹åˆ«æ˜¯ï¼Œ<code>&lt;send&gt;</code> å’Œ <code>&lt;raise&gt;</code> å…ƒç´  ä¸å¾—å‡ºç°ã€‚</p><p>children å¯ä»¥åŒ…å« å¯æ‰§è¡Œå†…å®¹ã€‚</p><p>XState æ²¡æœ‰å¯¹åº”çš„ APIï¼ŒXState å¯¹äºå¤„ç†æ¶ˆæ¯æ˜¯éå¸¸çµæ´»çš„ï¼Œæ‰€ä»¥è¿™ä¸€å—èƒ½åŠ›æ˜¯å†…ç½®è¿›å»çš„ã€‚</p><p>ç¤ºä¾‹ï¼š</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scxml</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>çŠ¶æ€æœº<span class="token punctuation">&quot;</span></span> <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1.0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2005/07/scxml<span class="token punctuation">&quot;</span></span> <span class="token attr-name">initial</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ç­‰å¾…ä¸­<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>datamodel</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>data</span> <span class="token attr-name">expr</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>VarValue<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>datamodel</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>state</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ç­‰å¾…ä¸­<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transition</span> <span class="token attr-name">event</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>childToParent<span class="token punctuation">&quot;</span></span> <span class="token attr-name">cond</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>VarValue==2<span class="token punctuation">&quot;</span></span> <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ç»“æŸ<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>invoke</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>å­çŠ¶æ€æœº<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/TR/scxml/<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>content</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scxml</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>å‘é€æ¶ˆæ¯åˆ°çˆ¶çº§å­çŠ¶æ€æœº<span class="token punctuation">&quot;</span></span> <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1.0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2005/07/scxml<span class="token punctuation">&quot;</span></span> <span class="token attr-name">initial</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>å®Œæˆ<span class="token punctuation">&quot;</span></span> <span class="token attr-name">initial</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>æ¿€æ´»ä¸­<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>final</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>å®Œæˆ<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>onentry</span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>send</span> <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#_parent<span class="token punctuation">&quot;</span></span> <span class="token attr-name">event</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>childToParent<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>aParam<span class="token punctuation">&quot;</span></span> <span class="token attr-name">expr</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>send</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>onentry</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>final</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scxml</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>content</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>finalize</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>assign</span> <span class="token attr-name">location</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>VarValue<span class="token punctuation">&quot;</span></span> <span class="token attr-name">expr</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>_event.data.aParam<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>finalize</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>invoke</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>state</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>final</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ç»“æŸ<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>final</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scxml</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-5-æœªå¯¹åº”-xstate-api" tabindex="-1"><a class="header-anchor" href="#_3-5-æœªå¯¹åº”-xstate-api" aria-hidden="true">#</a> 3.5 æœªå¯¹åº” XState API</h2><p>ä¸Šé¢æŒ‰ç…§è§„èŒƒä¸ XState è¿›è¡Œäº†å¯¹åº”ã€‚è¿˜æœ‰ä¸€éƒ¨åˆ†æ˜¯ XState ç‰¹è‰²äº§ç‰©ã€‚å¦‚ä¸‹ï¼š</p><ul><li>Actorï¼šActor æ¨¡å‹ï¼Œä¸€å¥—éå¸¸æˆç†Ÿçš„æ¨¡å‹ã€‚ç”¨æ¥æ‰©å±•å­çŠ¶æ€æœºã€‚</li><li>Interpreterï¼šç”±äº XState çš„çŠ¶æ€æœºæ˜¯ä¸€å¥—çº¯å‡½æ•°ç¼–å†™ï¼Œæ— ä»»ä½•å‰¯ä½œç”¨ã€‚æ‰€ä»¥å®˜æ–¹æä¾›äº†ä¸€ä¸ª Interpreter ç”¨æ¥æ‰˜ç®¡å‰¯ä½œç”¨ã€‚</li><li>Modelï¼šç”¨æ¥æ”¹å–„å¼€å‘äººå‘˜ä½“éªŒï¼Œåˆ†ç¦»å’Œç»„ç»‡ context å’Œ eventï¼Œå…±äº«æ¨¡å‹ã€‚</li></ul><h2 id="_3-6-å¯¹åº”å¤§å›¾" tabindex="-1"><a class="header-anchor" href="#_3-6-å¯¹åº”å¤§å›¾" aria-hidden="true">#</a> 3.6 å¯¹åº”å¤§å›¾</h2><p>æ•´ä¸ªå¯¹åº”å…³ç³»ï¼Œå¤§è‡´å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š <img src="/blog/assets/1662726673727.18c91177.webp" alt="" loading="lazy"></p><h1 id="_4-æœ€å" tabindex="-1"><a class="header-anchor" href="#_4-æœ€å" aria-hidden="true">#</a> 4. æœ€å</h1><p>è¿ç»­ç†¬äº†ä¸€ä¸ªå¤šæ˜ŸæœŸçš„å¤œï¼Œå¯¹ SCXML å’Œ XState çš„å…³ç³»è¿›è¡Œäº†æ¢³ç†å’Œå¯¹é½ï¼Œæœ€ç»ˆäº§å‡ºäº†è¿™ç¯‡ 4 ä¸‡ å¤šå­—çš„æ–‡ç« ã€‚</p><p>åšä¸ºä¸€ä¸ª XState çš„ â€œè¿‡æ¥äººâ€ï¼Œè¿™ç¯‡ä»è§„èŒƒåˆ°å·¥å…·å¯¹åº”å…³ç³»çš„æ–‡ç« ï¼Œæ­£æ˜¯å½“åˆé‚£ä¸ªåœ¨å…¥é—¨äº§ç”Ÿç–‘æƒ‘æ—¶çš„æˆ‘ï¼Œæœ€éœ€è¦çš„ä¸œè¥¿ã€‚</p><p>ä¹Ÿå¸Œæœ›è¿™ç¯‡æ–‡ç« å¯ä»¥å¸®åŠ©å…¥é—¨å’Œä½¿ç”¨çŠ¶æ€æœºåŠ XState çš„åŒå­¦è§£é™¤éƒ¨åˆ†ç–‘æƒ‘ã€‚</p></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/lecepin/blog/edit/main/demo/src/tech/å‰ç«¯çŠ¶æ€æœºç³»åˆ—ï¼šSCXMLä¸XStateå¯¹åº”å…³ç³».md" rel="noopener noreferrer" target="_blank" aria-label="ç¼–è¾‘æ­¤é¡µ" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->ç¼–è¾‘æ­¤é¡µ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><!----><!----></footer><!----><!----><!----><!--]--></main><!--]--><!----><!--]--></div><!--]--><!----><!--]--></div>
    <script type="module" src="/blog/assets/app.773cfef9.js" defer></script>
  </body>
</html>
